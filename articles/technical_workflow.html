<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Internal Workflow of semlbci() • semlbci</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Inter-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Cousine-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Internal Workflow of semlbci()">
<meta name="google-site-verification" content="0VLBmFnW_UJFI-7gXnORPBsWxqZwmzuGpK-TeVRLBjQ">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">semlbci</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.11.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/semlbci.html">Get started</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/loglike.html">Log Profile Likelihood of a Parameter</a></li>
    <li><a class="dropdown-item" href="../articles/technical_searching_one_bound.html">Searching for One Bound</a></li>
    <li><a class="dropdown-item" href="../articles/technical_workflow.html">Internal Workflow of semlbci()</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sfcheung/semlbci/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="technical_workflow_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="technical_workflow_files/d3-3.3.8/d3.min.js"></script><script src="technical_workflow_files/dagre-0.4.0/dagre-d3.min.js"></script><link href="technical_workflow_files/mermaid-0.3.0/dist/mermaid.css" rel="stylesheet">
<script src="technical_workflow_files/mermaid-0.3.0/dist/mermaid.slim.min.js"></script><link href="technical_workflow_files/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="technical_workflow_files/chromatography-0.1/chromatography.js"></script><script src="technical_workflow_files/DiagrammeR-binding-1.0.11/DiagrammeR.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Internal Workflow of semlbci()</h1>
                        <h4 data-toc-skip class="author">Shu Fai
Cheung</h4>
            
            <h4 data-toc-skip class="date">2025-01-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/sfcheung/semlbci/blob/v0.11.3/vignettes/articles/technical_workflow.Rmd" class="external-link"><code>vignettes/articles/technical_workflow.Rmd</code></a></small>
      <div class="d-none name"><code>technical_workflow.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette is a simplified version of the <a href="https://osf.io/q6e3h" class="external-link">technical appendix</a> hosted at the <a href="https://osf.io/b9a2p/" class="external-link">OSF project site</a> of <span class="citation">Cheung &amp; Pesigan (2023)</span>, associated with the
package <a href="https://sfcheung.github.io/semlbci/"><code>semlbci</code></a>. It
presents the workflow used by <code><a href="../reference/ci_i_one.html">ci_i_one()</a></code> and
<code><a href="../reference/ci_bound_wn_i.html">ci_bound_wn_i()</a></code> to find a bound of a likelihood-based
confidence interval (LBCI) of a parameter in a fitted
<code>lavaan</code> model.</p>
<p><code><a href="../reference/ci_i_one.html">ci_i_one()</a></code> and <code><a href="../reference/ci_bound_wn_i.html">ci_bound_wn_i()</a></code> are internal
functions used by <code><a href="../reference/semlbci.html">semlbci()</a></code>. They are not supposed to be
used by users. Nevertheless, developers can use them directly if so
desired.</p>
</div>
<div class="section level2">
<h2 id="purposes-of-the-functions">Purposes of the Functions<a class="anchor" aria-label="anchor" href="#purposes-of-the-functions"></a>
</h2>
<p><code><a href="../reference/ci_i_one.html">ci_i_one()</a></code> is called by <code><a href="../reference/semlbci.html">semlbci()</a></code> for each
confidence bound (limit), twice for each selected parameter, once for
the lower bound and once for the upper bound. It sets up necessary
arguments and then call the lowest level function responsible for
searching a bound.</p>
<p>Currently, only one such function is available,
<code><a href="../reference/ci_bound_wn_i.html">ci_bound_wn_i()</a></code>, which implements the algorithm proposed by
<span class="citation">Wu &amp; Neale (2012)</span>, adapted by <span class="citation">Pek &amp; Wu (2015)</span>, without the part for
handling parameters with attainable bounds. To avoid confusion with the
method by <span class="citation">Wu &amp; Neale (2012)</span> for
parameters with attainable bound, we denote this method WNPW
(Wu-Neale-Pek-Wu) method in this document.</p>
</div>
<div class="section level2">
<h2 id="overall-workflow">Overall Workflow<a class="anchor" aria-label="anchor" href="#overall-workflow"></a>
</h2>
<p>We first present the overall workflow<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Some steps are omitted for readability.&lt;/p&gt;"><sup>1</sup></a> of
<code><a href="../reference/semlbci.html">semlbci()</a></code>. We then present the workflow of
<code><a href="../reference/ci_i_one.html">ci_i_one()</a></code>, called by <code><a href="../reference/semlbci.html">semlbci()</a></code> once for each
bound of each parameter requested (twice for each parameter, once for
the lower bound and once for the upper bound). Last, we present the
workflows of the two stages of <code><a href="../reference/ci_bound_wn_i.html">ci_bound_wn_i()</a></code>, the
minimization stage and the checking stage.</p>
<p>Details for the arguments mentioned in this section can be found from
the help pages of <code><a href="../reference/semlbci.html">semlbci()</a></code>, <code><a href="../reference/ci_i_one.html">ci_i_one()</a></code>, and
<code><a href="../reference/ci_bound_wn_i.html">ci_bound_wn_i()</a></code>.</p>
<div class="section level3">
<h3 id="semlbci">
<code>semlbci()</code><a class="anchor" aria-label="anchor" href="#semlbci"></a>
</h3>
<p><code><a href="../reference/semlbci.html">semlbci()</a></code> is the main function used by users. It is used
to find the LBCI of selected parameters. It is also responsible for
setting the equality constraint required by the WNPW method. If robust
LBCI proposed by <span class="citation">Falk (2018)</span> is requested,
it will also compute the scaling and shift factors to be used by the
robust likelihood ratio test by <span class="citation">Satorra
(2000)</span>.</p>
<p>The general workflow of <code><a href="../reference/semlbci.html">semlbci()</a></code> is shown below:</p>
<div class="figure" style="text-align: center">
<div id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:650px;height:840px;" class="DiagrammeR html-widget"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"diagram":"\ngraph TD\n  classDef default fill:#DADBFF;\n  A[\"Is <code>check_fit<\/code> <code>TRUE<\/code>?\"]\n  A -- Yes --> AYes[\"Are the model and<br/>estimation method supported?<br/>(Checked by <code>check_sem_out()<\/code>)\"]\n  A --No--> B\n  AYes -- No --> AYesNo[\"Terminate and raise an error\"]\n  AYes --Yes--> B\n  B[\"Find the ids of parameters requested\"]\n  B --> C\n  C[\"Call <code>set_constraint()<\/code> to set the equality constraint<br/>used by the WNPW method\"]\n  C --> D\n  D[\"Robust LBCI requested?\"]\n  D -- Yes --> DYes\n  DYes[\"For each parameter,<br/>call <code>scaling_factor3()<\/code><br/>to compute the scaling and shift factors\"]\n  D -- No --> E\n  DYes --> E\n  E[\"Call <code>ci_i_one()<\/code> once for<br/>each bound of each parameter\"]\n  E --> F\n  F[\"Combine the bounds to form the confidence intervals<br/>and return the results\"]\n"},"evals":[],"jsHooks":[]}</script><p class="caption">
General Workflow of <code><a href="../reference/semlbci.html">semlbci()</a></code>
</p>
</div>
<p>We describe below the two functions called by <code><a href="../reference/semlbci.html">semlbci()</a></code>
in the workflow, <code><a href="../reference/set_constraint.html">set_constraint()</a></code> and
<code>:scaling_factor3()</code>.</p>
<div class="section level4">
<h4 id="set_constraint">
<code>set_constraint()</code><a class="anchor" aria-label="anchor" href="#set_constraint"></a>
</h4>
<p>This function, called by <code><a href="../reference/semlbci.html">semlbci()</a></code>, is used to set the
equality constraint used by the WNPW method.</p>
<p>As presented in <span class="citation">Pek &amp; Wu (2015)</span>, to
find the lower bound,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>L</mi></msub><annotation encoding="application/x-tex">\theta_L</annotation></semantics></math>,
of the
100(1-<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>)%
LBCI of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mi>j</mi></msub><annotation encoding="application/x-tex">\hat{\theta}_j</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>L</mi></msub><annotation encoding="application/x-tex">\theta_L</annotation></semantics></math>
is minimized with respect to all parameters,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>θ</mi><mi>L</mi></msub><mo>,</mo><msub><mi>𝛉</mi><mi>q</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(\theta_L, \boldsymbol{\theta}_q)</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝛉</mi><mi>𝐪</mi></msub><annotation encoding="application/x-tex">\boldsymbol{\theta_q}</annotation></semantics></math>
being all parameters other than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>L</mi></msub><annotation encoding="application/x-tex">\theta_L</annotation></semantics></math>,
subject to the following constraint:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>=</mo><mn>2</mn><mi>n</mi><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>θ</mi><mi>L</mi></msub><mo>,</mo><msub><mi>𝛉</mi><mi>𝐪</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mi>n</mi><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>θ</mi><mo accent="true">̂</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msubsup><mi>χ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
0 = 2nF(\theta_L, \boldsymbol{\theta_q}) - (2nF(\hat{\theta}) + \chi_{(1, 1 - \alpha)}^2)
</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>𝛉</mi><mo accent="true">̂</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F(\hat{\boldsymbol{\theta}})</annotation></semantics></math>
is the value of the discrepancy function evaluated at the ML estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>𝛉</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{\boldsymbol{\theta}}</annotation></semantics></math>.
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>χ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msubsup><annotation encoding="application/x-tex">\chi_{(1, 1 - \alpha)}^2</annotation></semantics></math>
is the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>
critical value at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>f</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">df = 1</annotation></semantics></math>
and level of significance =
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
(about 3.84 with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>.05</mn></mrow><annotation encoding="application/x-tex">\alpha = .05</annotation></semantics></math>),
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
is the sample size (total sample size in multisample models).</p>
<p>This constraint means that model
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>
difference test between the model with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\theta_j</annotation></semantics></math>
fixed to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>L</mi></msub><annotation encoding="application/x-tex">\theta_L</annotation></semantics></math>
and the original model with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\theta_j</annotation></semantics></math>
freely estimated should have a <em>p</em>-value equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>.</p>
<p>In <code>lavaan</code>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>θ</mi><mi>L</mi></msub><mo>,</mo><msub><mi>𝛉</mi><mi>q</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F(\theta_L, \boldsymbol{\theta}_q)</annotation></semantics></math>
is <code>"fmin"</code> in the output of
<code><a href="https://rdrr.io/pkg/lavaan/man/fitMeasures.html" class="external-link">lavaan::fitMeasures()</a></code>. When the estimator is
<code>ML</code> and <code>likelihood = "normal"</code>, the default,
multiplying <code>"fmin"</code> by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>n</mi></mrow><annotation encoding="application/x-tex">2n</annotation></semantics></math>
yields the model
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math>.</p>
<p>To find the upper bound,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>U</mi></msub><annotation encoding="application/x-tex">\theta_U</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><msub><mi>θ</mi><mi>U</mi></msub></mrow><annotation encoding="application/x-tex">-\theta_U</annotation></semantics></math>
is minimized (equivalently,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>U</mi></msub><annotation encoding="application/x-tex">\theta_U</annotation></semantics></math>
is maximized). The final value will be multiplied by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math>
to get the upper bound.</p>
<p>The WNPW method can easily be used when a model has one or more
equality constraints on the parameters. These constraints are simply
extracted from the <code>lavaan</code> object and passed to
<code><a href="https://astamm.github.io/nloptr/reference/nloptr.html" class="external-link">nloptr::nloptr()</a></code>, the function used to do the minimization,
along with the constraint by the WNPW method when minimizing the
objective function.</p>
<p>The function <code><a href="../reference/set_constraint.html">set_constraint()</a></code> returns a general version
of the constraint:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>=</mo><mn>2</mn><mi>n</mi><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>θ</mi><mi>L</mi></msub><mo>,</mo><msub><mi>𝛉</mi><mi>q</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mi>n</mi><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>𝛉</mi><mo accent="true">̂</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mfrac><mrow><msubsup><mi>χ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msubsup><mo>−</mo><mi>b</mi></mrow><mi>a</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
0 = 2nF(\theta_L, \boldsymbol{\theta}_q) - (2nF(\hat{\boldsymbol{\theta}}) + \frac{\chi_{(1, 1 - \alpha)}^2 - b}{a})
</annotation></semantics></math></p>
<p>In this general form,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>
is the scaling factor and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>
is the shift factor. When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">a = 1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">b = 0</annotation></semantics></math>,
it is the constraint in the WNPW method. When robust LBCI is requested,
the scaling and shift factors are computed as in the same way by
<code><a href="https://rdrr.io/pkg/lavaan/man/lavTestLRT.html" class="external-link">lavaan::lavTestLRT()</a></code> with
<code>method = satorra.2000</code> and
<code>A.method = "exact"</code>.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Internally, &lt;code&gt;sf = a^(-1)&lt;/code&gt; is stored. To be
consistent with &lt;code&gt;T_3&lt;/code&gt; presented in &lt;span class="citation"&gt;Asparouhov &amp;amp; Muthén (2010)&lt;/span&gt;, we used
&lt;code&gt;a&lt;/code&gt; instead of &lt;code&gt;a^(-1)&lt;/code&gt; in the equation in this
document.&lt;/p&gt;'><sup>2</sup></a></p>
</div>
<div class="section level4">
<h4 id="semlbciscaling_factors3">
<code>semlbci:::scaling_factors3()</code><a class="anchor" aria-label="anchor" href="#semlbciscaling_factors3"></a>
</h4>
<p>This internal function, not exported, computes the scaling and shift
factors used by <code><a href="https://rdrr.io/pkg/lavaan/man/lavTestLRT.html" class="external-link">lavaan::lavTestLRT()</a></code> with
<code>method = satorra.2000</code> and <code>A.method = "exact"</code>.
This is the method proposed by <span class="citation">Falk (2018)</span>
for robust LBCI. These factors can be used to do the robust likelihood
ratio test proposed by <span class="citation">Satorra (2000)</span>
without directly calling <code><a href="https://rdrr.io/pkg/lavaan/man/lavTestLRT.html" class="external-link">lavaan::lavTestLRT()</a></code> when doing
the minimization. Because these factors depend only on the parameter for
which the LBCI is to be searched, they can be computed once and reused
during the minimization.</p>
<p>Since version 0.6-13 of <code>lavaan</code>,
<code><a href="https://rdrr.io/pkg/lavaan/man/lavTestLRT.html" class="external-link">lavaan::lavTestLRT()</a></code> stores the scaling and shift factors
in the output. Therefore, for future versions of <code>semlbci</code>,
it is possible to remove <code>semlbci:::scaling_factor3()</code> and
use <code><a href="https://rdrr.io/pkg/lavaan/man/lavTestLRT.html" class="external-link">lavaan::lavTestLRT()</a></code> to get the scaling and shift
factors directly.</p>
</div>
</div>
<div class="section level3">
<h3 id="ci_i_one">
<code>ci_i_one()</code><a class="anchor" aria-label="anchor" href="#ci_i_one"></a>
</h3>
<p>The workflow of <code><a href="../reference/ci_i_one.html">ci_i_one()</a></code> is presented below:</p>
<div class="figure" style="text-align: center">
<div id="htmlwidget-e5c8c404fe174e4c81bd" style="width:700px;height:1300px;" class="DiagrammeR html-widget"></div>
<script type="application/json" data-for="htmlwidget-e5c8c404fe174e4c81bd">{"x":{"diagram":"\ngraph TD\n  classDef default fill:#F8DAFF;\n  B[\"Robust LBCI requested?\"]\n  B -- Yes --> C[\"Scaling and shift factors (<code>sf_full<\/code>)<br/>supplied by <code>semlbci()<\/code>?\"]\n  C -- No --> D[Compute scaling and shift factors]\n  D --> E\n  C -- Yes --> E[\"Call <code>ci_bound_wn_i()<\/code>\"]\n  B -- No --> E\n  E --> F[\"<code>status<\/code> == 0?\"]\n  F -- No --> G[\"Move the lower bounds<br/>of free variances closer to zero<br/>and call <code>ci_bound_wn_i()<\/code> again\"]\n  F -- Yes --> ZZ[\"Return the results to <code>semlbci()<\/code><br/>Bound set to <code>NA<\/code> if status != 0\"]\n  G --> H[\"<code>status<\/code> == 0?\"]\n  H -- Yes --> ZZ\n  H -- No --> I[\"Is <code>try_k_more_times<\/code> > 0?\"]\n  I -- No --> ZZ\n  I -- Yes --> J[\"Reduce the tolerance for convergence<br/>(Reduce <code>xtol_rel<\/code> and <code>ftol_rel<\/code>)\"]\n  J --> K[\"Call <code>ci_bound_wn_i()<\/code>\"]\n  K --> L[\"<code>status<\/code> == 0?\"]\n  L -- Yes --> ZZ\n  L -- No --> M[\"Tried<br/><code>try_k_more_times<\/code>?\"]\n  M -- No --> J\n  M -- Yes --> ZZ\n"},"evals":[],"jsHooks":[]}</script><p class="caption">
General Workflow of <code><a href="../reference/ci_i_one.html">ci_i_one()</a></code>
</p>
</div>
<p>Its job is to call <code><a href="../reference/ci_bound_wn_i.html">ci_bound_wn_i()</a></code> once or more than
once to find the bound of an LBCI of a parameter. It does not check the
validity or plausibility of the bound. The lowest level function,
<code><a href="../reference/ci_bound_wn_i.html">ci_bound_wn_i()</a></code>, is responsible for doing the checks. If
something is wrong, <code><a href="../reference/ci_bound_wn_i.html">ci_bound_wn_i()</a></code> will set
<code>status</code> to a non-zero value.</p>
<p>The argument <code>try_k_more_times</code> is used to determine
whether it will try “harder” for <em>k</em> more times if the first
attempt failed (e.g., <code>status != 0</code>, meaning that the bound
found fails one or more checks).</p>
</div>
<div class="section level3">
<h3 id="ci_bound_wn_i">
<code>ci_bound_wn_i()</code><a class="anchor" aria-label="anchor" href="#ci_bound_wn_i"></a>
</h3>
<p>The function <code><a href="../reference/ci_bound_wn_i.html">ci_bound_wn_i()</a></code> is the lowest level
function that is responsible for searching the bound. It implements an
optimization method (the WNPW method in this case) and takes care of all
the technical details. It is not supposed to be used by users and the
interface is not designed to be user-friendly. Nevertheless, interested
users can use it directly to find a bound, bypassing
<code><a href="../reference/semlbci.html">semlbci()</a></code>. Examples can be found in
<code><a href="../articles/technical_searching_one_bound.html">vignette("technical_searching_one_bound", package = "semlbci")</a></code>.</p>
<p>The workflow of <code><a href="../reference/ci_bound_wn_i.html">ci_bound_wn_i()</a></code> can be separated into
two stages, the <em>minimization stage</em> and the <em>checking
stage</em>.</p>
<div class="section level4">
<h4 id="minimization-stage">Minimization Stage<a class="anchor" aria-label="anchor" href="#minimization-stage"></a>
</h4>
<p>The workflow of the minimization stage is presented below:</p>
<div class="figure" style="text-align: center">
<div id="htmlwidget-36aa3d2a04d42bbc2145" style="width:500px;height:650px;" class="DiagrammeR html-widget"></div>
<script type="application/json" data-for="htmlwidget-36aa3d2a04d42bbc2145">{"x":{"diagram":"\ngraph TD\n  classDef default fill:#DAFFDA;\n  A[\"Store the point estimates and Wald or Delta CI\"]\n  A --> B[\"Define the function to be minimized [<code>lbci_b_f()<\/code>]<br/>and the gradient function of this function [<code>lbci_b_grad()<\/code>]\"]\n  B --> C[\"Is <code>wald_ci_start<\/code> TRUE?\"]\n  C -- Yes --> CYes[\"Call <code>set_start_wn()<\/code><br/>to set the starting values<br/>based on Wald or Delta CI\"]\n  C -- No --> CNo(\"Slighly pertubate<br/>the point estimates<br/> to set the starting values\")\n  CYes --> D[\"Set the lower bounds of free variances<br/>to a small positive value\"]\n  CNo --> D\n  D --> E[\"Call <code>>nloptr::nloptr()<\/code> to minimize the objective function,<br/>with the equality constraint <code>f_constr<\/code><br/>(created by <code>set_constraint()<\/code>)\"]\n  E --> F[\"Pass the results to the Checking Stage\"]\n"},"evals":[],"jsHooks":[]}</script><p class="caption">
Workflow of <code><a href="../reference/ci_bound_wn_i.html">ci_bound_wn_i()</a></code> - Minimization Stage
</p>
</div>
<div class="section level5">
<h5 id="optimization-algorithm">Optimization Algorithm<a class="anchor" aria-label="anchor" href="#optimization-algorithm"></a>
</h5>
<p>The function used to do the minimization is
<code><a href="https://astamm.github.io/nloptr/reference/nloptr.html" class="external-link">nloptr::nloptr()</a></code>, using <code>NLOPT_LD_SLSQP</code> as the
value for <code>algorithm</code>. The parameters (<code>x0</code>) are
all free parameters in the model. The objective function,
<code>eval_f</code> is set to <code>lbci_b_f()</code>, the function that
returns the bound in each iteration. The gradient function,
<code>eval_grad_f</code>, is <code>lbci_b_grad()</code>. The equality
constraint(s), <code>eval_g_eq</code>, is the result of
<code><a href="../reference/set_constraint.html">set_constraint()</a></code>, supplied through the argument
<code>f_constr</code> from <code><a href="../reference/semlbci.html">semlbci()</a></code>, along with other
equality constraints in the model, if any.</p>
<p>The two functions created by <code><a href="../reference/ci_bound_wn_i.html">ci_bound_wn_i()</a></code> in this
stage, <code>lbci_b_f()</code> and <code>lbci_b_grad()</code>, are
described below.</p>
<div class="section level6">
<h6 id="lbci_b_f">
<code>lbci_b_f()</code><a class="anchor" aria-label="anchor" href="#lbci_b_f"></a>
</h6>
<p>In the WNPW method, if the parameter,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\theta_j</annotation></semantics></math>,
is a free parameter, and the lower bound is to be searched, this
function simply returns the value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\theta_j</annotation></semantics></math>
(all other free parameters other than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\theta_j</annotation></semantics></math>
are denoted by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>q</mi></msub><annotation encoding="application/x-tex">\theta_q</annotation></semantics></math>):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>θ</mi><mi>j</mi></msub><mo>,</mo><msub><mi>𝛉</mi><mi>q</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>θ</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">
f(\theta_j, \boldsymbol{\theta}_q) = \theta_j
</annotation></semantics></math></p>
<p>If the upper bound is to be searched, then this function is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>θ</mi><mi>j</mi></msub><mo>,</mo><msub><mi>𝛉</mi><mi>q</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>−</mo><msub><mi>θ</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">
f(\theta_j, \boldsymbol{\theta}_q) = -\theta_j
</annotation></semantics></math></p>
<p>If the parameter is a function of some free parameters (e.g., an
indirect effect, or a standardized coefficient such as correlation),
denoted by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛉</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">h(\boldsymbol{\theta})</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝛉</mi><annotation encoding="application/x-tex">\boldsymbol{\theta}</annotation></semantics></math>
being all free parameters (though some may not be used in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math>),
and the lower bound is to be searched, then this function is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛉</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛉</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
f(\boldsymbol{\theta}) = h(\boldsymbol{\theta})
</annotation></semantics></math></p>
<p>Similarly, if the upper bound is to be searched, this function
is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛉</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>−</mo><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝛉</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
f(\boldsymbol{\theta}) = -h(\boldsymbol{\theta})
</annotation></semantics></math></p>
<p>Therefore, in the optimization, minimization is conducted whether the
lower or upper bound is to be searched.</p>
</div>
<div class="section level6">
<h6 id="lbci_b_grad">
<code>lbci_b_grad()</code><a class="anchor" aria-label="anchor" href="#lbci_b_grad"></a>
</h6>
<p>The gradient of the object function, <code>lbci_b_f()</code>, is
either precomputed (if the parameter for which the bound is being
searched is a parameter) or computed by
<code><a href="https://rdrr.io/pkg/lavaan/man/lav_func.html" class="external-link">lavaan::lav_func_gradient_complex()</a></code>.</p>
</div>
</div>
<div class="section level5">
<h5 id="tweaking-the-optimization">Tweaking the Optimization<a class="anchor" aria-label="anchor" href="#tweaking-the-optimization"></a>
</h5>
<p>The first attempt of optimization may fail, especially when the
target parameter is a function of free parameters (e.g., an indirect
effect, or a parameter in the standardized solution). The arguments
<code>xtol_rel</code>, <code>ftol_rel</code>, and <code>lb</code> are
adjusted across attempts. This is done by <code><a href="../reference/ci_i_one.html">ci_i_one()</a></code> for
the second and subsequent calls to <code><a href="../reference/ci_bound_wn_i.html">ci_bound_wn_i()</a></code>.</p>
</div>
</div>
<div class="section level4">
<h4 id="checking-stage">Checking Stage<a class="anchor" aria-label="anchor" href="#checking-stage"></a>
</h4>
<p>The workflow of the checking stage is presented below:</p>
<div class="figure" style="text-align: center">
<div id="htmlwidget-febe03efa1a2d8d52a86" style="width:600px;height:1200px;" class="DiagrammeR html-widget"></div>
<script type="application/json" data-for="htmlwidget-febe03efa1a2d8d52a86">{"x":{"diagram":"\ngraph TD\n  classDef default fill:#FFE1DA;\n  classDef statusNA fill:#ffdddd;\n  class DNo,FNo,GNo statusNA\n%%  DNo:::statusNA\n%%  FNo:::statusNA\n%%  GNo:::statusNA\n  A[\"Which bound is requested?\"]\n  A -- Upper --> AUpper[\"Multiply the value by -1\"]\n  AUpper --> B[\"Store the value to <code>bound<\/code>\"]\n  A -- Lower --> B\n  B --> C[\"Initialize <code>status<\/code> to 0\"]\n  C --> D[\"<b>Check <code>nloptr<\/code> Status<\/b>:<br/>Is status code from <code>nloptr<\/code> equal to 0?\"]\n  D -- No --> DNo[\"Set <code>status<\/code> to 1\"]\n  DNo --> F[\"<b>Check SEM Solution<\/b>:<br/>Is the <code>lavaan<\/code> results based on <code>nloptr<\/code> solution admissible?\"]\n  D -- Yes --> F\n  F -- No --> FNo[\"Set <code>status<\/code> to 1\"]\n  FNo --> G[\"<b>Check the Achieved Level of Significance<\/b>:<br/>Is the <i>p<\/i>-value of the 1-<i>df<\/i> likelihood ratio test<br/>close enough to 1 - Confidence Level? (.05 for 95%)<br/>(<code>p_tol<\/code> used as the tolerance) (For robust LBCI, scaling and shift factors are used)\"]\n  F -- Yes --> G\n  G -- No --> GNo[\"Set <code>status<\/code> to 1\"]\n  GNo --> E[\"Set <code>ci_limit_ratio<\/code> to the ratio of distances from the point estimate:<br/>(LBCI bound from point estimate) / (Wald or Delta bound to point estimate)\"]\n  G -- Yes --> E\n  E --> H[\"Is <code>status<\/code> equal to 0?\"]\n  H -- No --> HNo[\"Set <code>bound<\/code> to <code>NA<\/code>\"]\n  HNo --> I[\"Return the results\"]\n  H -- Yes --> I\n"},"evals":[],"jsHooks":[]}</script><p class="caption">
Workflow of <code><a href="../reference/ci_bound_wn_i.html">ci_bound_wn_i()</a></code> - Checking Stage
</p>
</div>
<p>It will do the following checks, in this order:</p>
<ol style="list-style-type: decimal">
<li>
<p>Is the status code of <code><a href="https://astamm.github.io/nloptr/reference/nloptr.html" class="external-link">nloptr::nloptr()</a></code> equal to 0
(“success”)?</p>
<p>If the status code of <code><a href="https://astamm.github.io/nloptr/reference/nloptr.html" class="external-link">nloptr::nloptr()</a></code> is not equal to
0, then the status code for <code><a href="../reference/ci_bound_wn_i.html">ci_bound_wn_i()</a></code> will be set to
1.</p>
</li>
<li>
<p>In final solution, do the values of the free parameters result in
an admissible solution? (Checked by <code><a href="https://rdrr.io/pkg/lavaan/man/lavInspect.html" class="external-link">lavaan::lavInspect()</a></code>
with <code>what = "post.check"</code>).</p>
<p>The values of the parameters in the final solution is used to fit the
model, and then <code><a href="https://rdrr.io/pkg/lavaan/man/lavInspect.html" class="external-link">lavaan::lavInspect()</a></code> is called to check the
solution. Examples of inadmissible solution are negative variances and
correlations greater than one in magnitude.</p>
<p>If the solution is not admissible, then the status code for
<code><a href="../reference/ci_bound_wn_i.html">ci_bound_wn_i()</a></code> will be set to 1.</p>
</li>
<li>
<p>When the target parameter (free or derived, i.e., the function of
parameters, such as an indirect effect or a standardized regression
coefficient) is fixed to the bound found, is the <em>p</em>-value of the
likelihood ratio test between this constrained model and the original
model equal to 1 - confidence level (.05 for a 95% LBCI)?</p>
<p>If not, then the likelihood-based confidence bound is by
<em>definition</em> <em>invalid</em>. The status code for
<code><a href="../reference/ci_bound_wn_i.html">ci_bound_wn_i()</a></code> will be set to 1.</p>
<p>The check is equivalent to using <code><a href="https://rdrr.io/pkg/lavaan/man/lavTestLRT.html" class="external-link">lavaan::lavTestLRT()</a></code>.
If robust LBCI is requested, then the check is equivalent to using
<code><a href="https://rdrr.io/pkg/lavaan/man/lavTestLRT.html" class="external-link">lavaan::lavTestLRT()</a></code> with
<code>method = satorra.2000</code> and
<code>A.method = "exact"</code>.</p>
</li>
</ol>
<p>The bound is set to <code>NA</code> if the solution fails any of the
three checks presented above, to prevent users from accidentally using a
bound that may be invalid.</p>
<p>In sum, the bound returned, if not <code>NA</code>, has the following
characteristics:</p>
<ul>
<li><p>Noted as “success” in the optimization by
<code><a href="https://astamm.github.io/nloptr/reference/nloptr.html" class="external-link">nloptr::nloptr()</a></code>.</p></li>
<li><p>The values of the parameters do not yield an inadmissible
solution.</p></li>
<li><p>The bound is <em>by definition</em> valid.</p></li>
</ul>
</div>
</div>
</div>
<div class="section level2">
<h2 id="main-arguments">Main Arguments<a class="anchor" aria-label="anchor" href="#main-arguments"></a>
</h2>
<p>This section presents in details the arguments used by
<code><a href="../reference/ci_i_one.html">ci_i_one()</a></code> and <code><a href="../reference/ci_bound_wn_i.html">ci_bound_wn_i()</a></code>.</p>
<div class="section level3">
<h3 id="ci_i_one-1">
<code>ci_i_one()</code><a class="anchor" aria-label="anchor" href="#ci_i_one-1"></a>
</h3>
<p><code><a href="../reference/ci_i_one.html">ci_i_one()</a></code> is an interface between user functions such
as <code><a href="../reference/semlbci.html">semlbci()</a></code> and low level functions such as
<code><a href="../reference/ci_bound_wn_i.html">ci_bound_wn_i()</a></code>. It is responsible for setting necessary
values to be used by <code><a href="../reference/ci_bound_wn_i.html">ci_bound_wn_i()</a></code>.</p>
<p>These are the main arguments of <code><a href="../reference/ci_i_one.html">ci_i_one()</a></code>:</p>
<ul>
<li>
<p><code>i</code>:</p>
<p>The position (row number) of the target parameters as appeared in the
parameter table of the output of <code><a href="https://rdrr.io/pkg/lavaan/man/lavaan.html" class="external-link">lavaan::lavaan()</a></code> and its
wrappers, such as <code><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">lavaan::sem()</a></code> and
<code><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">lavaan::cfa()</a></code>. This uniquely identifies a parameter, which
can be free, fixed, or user-defined.</p>
</li>
<li>
<p><code>which</code>:</p>
<p>Either <code>"lbound"</code> or <code>"ubound"</code>, denoting lower
bound and upper bound, respectively. The confidence bound (limit) to be
searched.</p>
</li>
<li>
<p><code>sem_out</code>:</p>
<p>A <code>lavaan</code>-class object. the output of
<code><a href="https://rdrr.io/pkg/lavaan/man/lavaan.html" class="external-link">lavaan::lavaan()</a></code> and its wrappers, such as
<code><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">lavaan::sem()</a></code> and <code><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">lavaan::cfa()</a></code>.</p>
</li>
<li>
<p><code>method</code>:</p>
<p>The method to be used to find a confidence bound. Currently, only the
modified Wu-Neale method presented by Pek and Wu (2015) is supported
(<code>"wn"</code>). Separating the low level function from this
function allows for the possibility to develop low level functions for
other methods, without the need to change the interface implemented in
<code><a href="../reference/ci_i_one.html">ci_i_one()</a></code>.</p>
</li>
<li>
<p><code>standardized</code>:</p>
<p>Logical. Whether the confidence bound of the parameter in the
standardized solution is to be searched. For example, for a covariance,
whether the covariance, or the correlation, is to be used in searching
the bound. Default is <code>FALSE</code>.</p>
</li>
<li>
<p><code>robust</code>:</p>
<p>Whether robust likelihood-based confidence bound is to be searched,
and if yes, the method to be used. Currently only support
<code>"none"</code> (robust method not used) or
<code>"satorra.2000"</code>, proposed by <span class="citation">Falk
(2018)</span>.</p>
</li>
<li>
<p><code>sf_full</code>:</p>
<p>Used when <code>robust</code> is <code>"satorra.2000"</code>. If
<code>NA</code>, the scaling and shift factors used in the likelihood
ratio test will be computed internally. If supplied, it should be a list
with two scalar elements, <code>c_r</code> and <code>c_rb</code>, the
scaling factor and the shift factors.</p>
</li>
<li>
<p><code>sf_args</code>:</p>
<p>If <code>robust</code> is <code>"satorra.2000"</code> and
<code>sf_full</code> is <code>NA</code>, this is a named list of
arguments to be passed to <code>semlbci:::scaling_factor3()</code>, an
internal function for computing the scaling and shift factors proposed
by <span class="citation">Asparouhov &amp; Muthén
(2010)</span>.</p>
</li>
<li>
<p><code>try_k_more_times</code>:</p>
<p>How many more times to try if the status code is not zero. Default is
0 but <code><a href="../reference/semlbci.html">semlbci()</a></code> set this argument to 2 when calling this
function. If set to an integer greater than zero, it will call the low
level function until the status code is zero or until this number of
additional calls have been attempted. In each successive call, some
values will be modified to do the search using these new
settings.</p>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="ci_bound_wn_i-1">
<code>ci_bound_wn_i()</code><a class="anchor" aria-label="anchor" href="#ci_bound_wn_i-1"></a>
</h3>
<p><code><a href="../reference/ci_bound_wn_i.html">ci_bound_wn_i()</a></code> is the low level function called by
<code><a href="../reference/ci_i_one.html">ci_i_one()</a></code>. This function implements the modified Wu-Neale
method presented by <span class="citation">Pek &amp; Wu (2015)</span>,
named Wu-Neale-Pek-Wu (WNPW) method in this document. This function is
not supposed to be used by users and the interface is not user-friendly.
Interested users can refer to
<code><a href="../articles/technical_searching_one_bound.html">vignette("technical_searching_one_bound", package = "semlbci")</a></code>
to see how to use <code><a href="../reference/ci_bound_wn_i.html">ci_bound_wn_i()</a></code> directly.</p>
<p>These are the main arguments of <code><a href="../reference/ci_bound_wn_i.html">ci_bound_wn_i()</a></code>:</p>
<ul>
<li>
<p><code>i</code>:</p>
<p>The position (row number) of the target parameters as appeared in the
parameter table of the output of <code><a href="https://rdrr.io/pkg/lavaan/man/lavaan.html" class="external-link">lavaan::lavaan()</a></code> and its
wrappers, such as <code><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">lavaan::sem()</a></code> and
<code><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">lavaan::cfa()</a></code>. This id uniquely identifies a parameter,
which can be free, fixed, or user-defined.</p>
</li>
<li>
<p><code>npar</code>:</p>
<p>The number of free parameters in the model, including those
constrained to be equal. To be supplied by
<code><a href="../reference/ci_i_one.html">ci_i_one()</a></code>.</p>
</li>
<li>
<p><code>sem_out</code>:</p>
<p>A <code>lavaan</code>-class object. the output of
<code><a href="https://rdrr.io/pkg/lavaan/man/lavaan.html" class="external-link">lavaan::lavaan()</a></code> and its wrappers, such as
<code><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">lavaan::sem()</a></code> and <code><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">lavaan::cfa()</a></code>.</p>
</li>
<li>
<p><code>f_constr</code>:</p>
<p>The constraint function generated by <code><a href="../reference/set_constraint.html">set_constraint()</a></code>.
Created by <code><a href="../reference/semlbci.html">semlbci()</a></code> and then passed to it through
<code><a href="../reference/ci_i_one.html">ci_i_one()</a></code>.</p>
</li>
<li>
<p><code>which</code>:</p>
<p>Either <code>"lbound"</code> or <code>"ubound"</code>, denoting lower
bound and upper bound, respectively. The confidence bound (limit) to be
searched.</p>
</li>
<li>
<p><code>perturbation_factor</code>:</p>
<p>The number by which the parameter estimates in <code>sem_out</code>
will be multiplied, to set the starting values, because using the
parameter estimates as starting values may lead to errors in the first
few iterations. Default is .90. This argument is ignored if
<code>wald_ci_start</code>, described below, is
<code>TRUE</code>.</p>
</li>
<li>
<p><code>lb_var</code>:</p>
<p>The lower bound for free parameters that are variances. If equal to
<code>-Inf</code>, the default, <code>lb_prop</code> and
<code>lb_se_k</code>, described below, will be used to set the lower
bounds for free variances. If it is a number, it will be used to set the
lower bounds for all free variances.</p>
</li>
<li>
<p><code>wald_ci_start</code>:</p>
<p>If <code>TRUE</code>, there are no equality constraints in the model,
and the target parameter is not a user-defined parameter, the Wald or
delta confidence bounds will be used as the starting values.</p>
</li>
<li>
<p><code>standardized</code>:</p>
<p>Logical. Whether the confidence bound of the parameter in the
standardized solution is to be searched. For example, for a covariance,
whether the covariance, or the correlation, is to be used in searching
the bound. Default is <code>FALSE</code>.</p>
</li>
<li>
<p><code>opts</code>:</p>
<p>A named list of options to be passed to
<code><a href="https://astamm.github.io/nloptr/reference/nloptr.html" class="external-link">nloptr::nloptr()</a></code>, the function used for the optimization.
Default is <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code>. This argument can be used to override
internal settings used by <code><a href="../reference/ci_bound_wn_i.html">ci_bound_wn_i()</a></code>.</p>
</li>
<li>
<p><code>ciperc</code>:</p>
<p>The intended coverage probability for the confidence interval.
Default is .95, and the bound for a 95% likelihood-based confidence
interval will be sought.</p>
</li>
<li>
<p><code>ci_limit_ratio_tol</code>:</p>
<p>The tolerance for the ratio of <code>a</code> to <code>b</code>,
where <code>a</code> is the distance between an bound of an LBCI and the
point estimate, and the <code>b</code> is the distance between the
original confidence bound (by default the Wald or delta CI in
<code><a href="https://rdrr.io/pkg/lavaan/man/lavaan.html" class="external-link">lavaan::lavaan()</a></code>) and the point estimate. If the ratio is
larger than this value or smaller than the reciprocal of this value, a
warning is set in the status code. Default is 1.5.</p>
</li>
<li>
<p><code>verbose</code>:</p>
<p>If <code>TRUE</code>, the function will store more diagnostic
information in the attribute <code>diag</code>. Default is
<code>FALSE</code>.</p>
</li>
<li>
<p><code>sf</code>:</p>
<p>A scaling factor. Used for robust confidence bounds. Default is 1.
Precomputed by an internal function called by <code><a href="../reference/semlbci.html">semlbci()</a></code> or
<code><a href="../reference/ci_i_one.html">ci_i_one()</a></code> when
<code>robust = "satorra.2000"</code>.</p>
</li>
<li>
<p><code>sf2</code>:</p>
<p>A shift factor. Used for robust confidence bounds. Default is 1.
Precomputed by an internal function called by <code><a href="../reference/semlbci.html">semlbci()</a></code> or
<code><a href="../reference/ci_i_one.html">ci_i_one()</a></code> when
<code>robust = "satorra.2000"</code>.</p>
</li>
<li>
<p><code>p_tol</code>:</p>
<p>The tolerance for checking the achieved level of confidence, that is,
the <em>p</em>-value of the likelihood ratio test between the original
model and the model with the parameter fixed to the bound found. If the
absolute difference between the achieved level and <code>ciperc</code>
is greater than this number, a warning is set in the status code and the
bound is set to <code>NA</code>. Default is 5e-4.</p>
</li>
<li>
<p><code>xtol_rel_factor</code>:</p>
<p>Multiply the internal default value of <code>xtol_rel</code> for
<code><a href="https://astamm.github.io/nloptr/reference/nloptr.html" class="external-link">nloptr::nloptr()</a></code> (1.0e-5) by this number, usually a
positive number equal to or less than 1, to change the default
termination criterion. Default is 1. This allows tweaking the settings
for optimization without knowing the internal default value.</p>
</li>
<li>
<p><code>ftol_rel_factor</code>:</p>
<p>Multiply the internal default value of <code>ftol_rel</code> for
<code><a href="https://astamm.github.io/nloptr/reference/nloptr.html" class="external-link">nloptr::nloptr()</a></code> (1.0e-5) by this number, usually a
positive number equal to or less than 1, to change the default
termination criterion. Default is 1. This allows tweaking the settings
for optimization without knowing the internal default value.</p>
</li>
<li>
<p><code>lb_prop</code>:</p>
<p>Used by an internal function to set the lower bound for free
variances. Default is .05, setting the lower bound to (.05)(point
estimate). Used only if the lower bound set by <code>lb_se_k</code> is
negative. This constraint is used only in the optimization to prevent
intermediate values too far away from the point estimates. The final
check done by fitting the model in <code>lavaan</code> will not
implement this constraint.</p>
</li>
<li>
<p><code>lb_se_k</code></p>
<p>Used by an internal function to set the lower bound for free
variances. Default is 3, the estimate minus 3
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>×</mo><annotation encoding="application/x-tex">\times</annotation></semantics></math>
standard error. If negative, the lower bound is set using
<code>lb_prop</code>. This constraint is used only in the optimization
to prevent intermediate values too far away from the point estimates.
The final check done by fitting the model in <code>lavaan</code> will
not implement this constraint.</p>
</li>
</ul>
<p>Please refer to the help page of <code><a href="../reference/ci_bound_wn_i.html">ci_bound_wn_i()</a></code> to
learn about other arguments.</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-asparouhov_simple_2010" class="csl-entry">
Asparouhov, T., &amp; Muthén, B. O. (2010). <em>Simple second order
chi-square correction</em>. <a href="https://www.statmodel.com/download/WLSMV_new_chi21.pdf" class="external-link">https://www.statmodel.com/download/WLSMV_new_chi21.pdf</a>
</div>
<div id="ref-cheung_semlbci_2023" class="csl-entry">
Cheung, S. F., &amp; Pesigan, I. J. A. (2023). <em>Semlbci</em>: An r
package for forming likelihood-based confidence intervals for parameter
estimates, correlations, indirect effects, and other derived parameters.
<em>Structural Equation Modeling: A Multidisciplinary Journal</em>,
<em>30</em>(6), 985–999. <a href="https://doi.org/10.1080/10705511.2023.2183860" class="external-link">https://doi.org/10.1080/10705511.2023.2183860</a>
</div>
<div id="ref-falk_are_2018" class="csl-entry">
Falk, C. F. (2018). Are robust standard errors the best approach for
interval estimation with nonnormal data in structural equation modeling?
<em>Structural Equation Modeling: A Multidisciplinary Journal</em>,
<em>25</em>(2), 244–266. <a href="https://doi.org/10.1080/10705511.2017.1367254" class="external-link">https://doi.org/10.1080/10705511.2017.1367254</a>
</div>
<div id="ref-pek_profile_2015" class="csl-entry">
Pek, J., &amp; Wu, H. (2015). Profile likelihood-based confidence
intervals and regions for structural equation models.
<em>Psychometrika</em>, <em>80</em>(4), 1123–1145. <a href="https://doi.org/10.1007/s11336-015-9461-1" class="external-link">https://doi.org/10.1007/s11336-015-9461-1</a>
</div>
<div id="ref-satorra_scaled_2000" class="csl-entry">
Satorra, A. (2000). Scaled and adjusted restricted tests in multi sample
analysis of moment structures. In R. D. H. Heijmans, D. S. G. Pollock,
&amp; A. Satorra (Eds.), <em>Innovations in multivariate statistical
analysis. Advanced studies in theoretical and applied econometrics</em>
(Vol. 36). Springer.
</div>
<div id="ref-wu_adjusted_2012" class="csl-entry">
Wu, H., &amp; Neale, M. C. (2012). Adjusted confidence intervals for a
bounded parameter. <em>Behavior Genetics</em>, <em>42</em>(6), 886–898.
<a href="https://doi.org/10.1007/s10519-012-9560-z" class="external-link">https://doi.org/10.1007/s10519-012-9560-z</a>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Shu Fai Cheung.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
