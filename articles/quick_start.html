<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quick Start • semlbci</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Quick Start">
<meta property="og:description" content="semlbci">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">semlbci</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/quick_start.html">Quick Start</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="quick_start_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Quick Start</h1>
                        <h4 class="author">Shu Fai Cheung</h4>
            
            <h4 class="date">2021-04-25</h4>
      
      
      <div class="hidden name"><code>quick_start.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">semlbci</span><span class="op">)</span></code></pre></div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This package includes functions for finding the likelihood based confidence intervals (LBCIs) of parameters in the output of a structural equation modeling (SEM) function. Currently, it supports the output from <code><a href="https://rdrr.io/pkg/lavaan/man/lavaan.html">lavaan::lavaan()</a></code>.</p>
</div>
<div id="fit-a-model-to-a-dataset" class="section level1">
<h1 class="hasAnchor">
<a href="#fit-a-model-to-a-dataset" class="anchor"></a>Fit a model to a dataset</h1>
<p>The package has a dataset, <code>simple_med</code>, with three variables, <code>x</code>, <code>m</code>, and <code>y</code>. Let us fit a simple mediation model to this datast.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">simple_med</span><span class="op">)</span>
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">simple_med</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>
<span class="co">#&gt;            x          m         y</span>
<span class="co">#&gt; 1 -0.3447375   7.284273 -5.636897</span>
<span class="co">#&gt; 2 -0.3658919  -5.449121 -4.525402</span>
<span class="co">#&gt; 3 -0.8294968  -7.016254 -7.823257</span>
<span class="co">#&gt; 4 -0.3389654   4.367018  1.563098</span>
<span class="co">#&gt; 5 -0.9628162  -4.015469 -7.288511</span>
<span class="co">#&gt; 6 -1.0749302 -11.538140 -4.153572</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be">lavaan</a></span><span class="op">)</span>
<span class="co">#&gt; This is lavaan 0.6-8</span>
<span class="co">#&gt; lavaan is FREE software! Please report any bugs.</span>
<span class="va">mod</span> <span class="op">&lt;-</span> 
<span class="st">"
m ~ a*x
y ~ b*m
ab := a * b
"</span>
<span class="co"># We set fixed.x = FALSE because we will also find the LBCIs for standardized solution</span>
<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html">sem</a></span><span class="op">(</span><span class="va">mod</span>, <span class="va">simple_med</span>, fixed.x <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>If we want to find the LBCIs for standardized solution, we usually should also treat the exogenous variables as random variables such that the sampling error in estimating their variances and covariances will be taken into account.</p>
<p>To illustrate how to find the LBCIs for user-defined parameters, we labelled the <code>m ~ x</code> path by <code>a</code>, the <code>y ~ m</code> path by <code>b</code>, and defined the indirect effect, <code>ab</code>, by <code>a * b</code>.</p>
<p>This is the summary:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">fit</span>, standardized <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; lavaan 0.6-8 ended normally after 19 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Estimator                                         ML</span>
<span class="co">#&gt;   Optimization method                           NLMINB</span>
<span class="co">#&gt;   Number of model parameters                         5</span>
<span class="co">#&gt;                                                       </span>
<span class="co">#&gt;   Number of observations                           200</span>
<span class="co">#&gt;                                                       </span>
<span class="co">#&gt; Model Test User Model:</span>
<span class="co">#&gt;                                                       </span>
<span class="co">#&gt;   Test statistic                                10.549</span>
<span class="co">#&gt;   Degrees of freedom                                 1</span>
<span class="co">#&gt;   P-value (Chi-square)                           0.001</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Parameter Estimates:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Standard errors                             Standard</span>
<span class="co">#&gt;   Information                                 Expected</span>
<span class="co">#&gt;   Information saturated (h1) model          Structured</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Regressions:</span>
<span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span>
<span class="co">#&gt;   m ~                                                                   </span>
<span class="co">#&gt;     x          (a)    1.676    0.431    3.891    0.000    1.676    0.265</span>
<span class="co">#&gt;   y ~                                                                   </span>
<span class="co">#&gt;     m          (b)    0.535    0.073    7.300    0.000    0.535    0.459</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Variances:</span>
<span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span>
<span class="co">#&gt;    .m                34.710    3.471   10.000    0.000   34.710    0.930</span>
<span class="co">#&gt;    .y                40.119    4.012   10.000    0.000   40.119    0.790</span>
<span class="co">#&gt;     x                 0.935    0.094   10.000    0.000    0.935    1.000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Defined Parameters:</span>
<span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span>
<span class="co">#&gt;     ab                0.897    0.261    3.434    0.001    0.897    0.122</span></code></pre></div>
</div>
<div id="exmaples" class="section level1">
<h1 class="hasAnchor">
<a href="#exmaples" class="anchor"></a>Exmaples</h1>
<p>The main function to find the LBCIs for free parameters is <code><a href="../reference/semlbci.html">semlbci()</a></code>. This should be the only function used by normal users. We will first illustrate its usage by some examples, and then present other technical details in the following section.</p>
<div id="find-the-lbci-for-a-free-parameter" class="section level2">
<h2 class="hasAnchor">
<a href="#find-the-lbci-for-a-free-parameter" class="anchor"></a>Find the LBCI for a free parameter</h2>
<p>All free parameters can be specified in <code>lavaan</code> style. For example, the path from <code>m</code> to <code>y</code> is denoted by <code>"y ~ m"</code>, and the covariance or correlation between <code>x</code> and <code>m</code> (not in the example) is denoted by <code>"x ~~ m"</code> (order does not matter).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/semlbci.html">semlbci</a></span><span class="op">(</span>sem_out <span class="op">=</span> <span class="va">fit</span>,
               pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y ~ m"</span>,
                        <span class="st">"m ~ x"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The output is the parameter table of the fitted <code>lavaan</code> object, with two columns added, <code>lbci_lb</code> and <code>lbci_ub</code>, the likelihood-based lower bounds and upper bounds, respectively. The column of point estimates in the fit object is positioned between these two columns of bounds. Diagnostic information will also be appended to the output (described in details below).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out</span>
<span class="co">#&gt;   id lhs op rhs   lbci_lb        est   lbci_ub status_lb status_ub ci_org_lb</span>
<span class="co">#&gt; 1  1   m  ~   x 0.8277017  1.6761271 2.5245536         0         0 0.8317719</span>
<span class="co">#&gt; 2  2   y  ~   m 0.3907302  0.5350831 0.6794351         0         0 0.3914232</span>
<span class="co">#&gt; 3  3   m ~~   m        NA 34.7102956        NA        NA        NA        NA</span>
<span class="co">#&gt; 4  4   y ~~   y        NA 40.1189462        NA        NA        NA        NA</span>
<span class="co">#&gt; 5  5   x ~~   x        NA  0.9351346        NA        NA        NA        NA</span>
<span class="co">#&gt; 6  6  ab := a*b        NA  0.8968672        NA        NA        NA        NA</span>
<span class="co">#&gt;   ci_org_ub ratio_lb ratio_ub post_check_lb post_check_ub time_lb time_ub</span>
<span class="co">#&gt; 1 2.5204823 1.004821 1.004822          TRUE          TRUE   0.516   0.451</span>
<span class="co">#&gt; 2 0.6787429 1.004824 1.004818          TRUE          TRUE   0.450   0.459</span>
<span class="co">#&gt; 3        NA       NA       NA            NA            NA      NA      NA</span>
<span class="co">#&gt; 4        NA       NA       NA            NA            NA      NA      NA</span>
<span class="co">#&gt; 5        NA       NA       NA            NA            NA      NA      NA</span>
<span class="co">#&gt; 6        NA       NA       NA            NA            NA      NA      NA</span>
<span class="co">#&gt;   method</span>
<span class="co">#&gt; 1     nm</span>
<span class="co">#&gt; 2     nm</span>
<span class="co">#&gt; 3   &lt;NA&gt;</span>
<span class="co">#&gt; 4   &lt;NA&gt;</span>
<span class="co">#&gt; 5   &lt;NA&gt;</span>
<span class="co">#&gt; 6   &lt;NA&gt;</span></code></pre></div>
<p>In this example, the point estimate of the unstandardized coefficient from <code>x</code> to <code>m</code> is 1.6761271, and the LBCI is 0.8277017 to 2.5245536.</p>
</div>
<div id="find-the-lbci-for-a-user-defined-parameter" class="section level2">
<h2 class="hasAnchor">
<a href="#find-the-lbci-for-a-user-defined-parameter" class="anchor"></a>Find the LBCI for a user-defined parameter</h2>
<p>To find the LBCI for a user-defined parameter, use <code>label :=</code>, where <code>label</code> is the label used in the model specification. The definition of this parameter can be omitted. The content after <code>:=</code> will be ignored by <code><a href="../reference/semlbci.html">semlbci()</a></code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/semlbci.html">semlbci</a></span><span class="op">(</span>sem_out <span class="op">=</span> <span class="va">fit</span>,
               pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ab := "</span><span class="op">)</span><span class="op">)</span>
<span class="va">out</span>
<span class="co">#&gt;   id lhs op rhs   lbci_lb        est  lbci_ub status_lb status_ub ci_org_lb</span>
<span class="co">#&gt; 1  1   m  ~   x        NA  1.6761271       NA        NA        NA        NA</span>
<span class="co">#&gt; 2  2   y  ~   m        NA  0.5350831       NA        NA        NA        NA</span>
<span class="co">#&gt; 3  3   m ~~   m        NA 34.7102956       NA        NA        NA        NA</span>
<span class="co">#&gt; 4  4   y ~~   y        NA 40.1189462       NA        NA        NA        NA</span>
<span class="co">#&gt; 5  5   x ~~   x        NA  0.9351346       NA        NA        NA        NA</span>
<span class="co">#&gt; 6  6  ab := a*b 0.4265273  0.8968672 1.464077         0         0  0.384906</span>
<span class="co">#&gt;   ci_org_ub  ratio_lb ratio_ub post_check_lb post_check_ub time_lb time_ub</span>
<span class="co">#&gt; 1        NA        NA       NA            NA            NA      NA      NA</span>
<span class="co">#&gt; 2        NA        NA       NA            NA            NA      NA      NA</span>
<span class="co">#&gt; 3        NA        NA       NA            NA            NA      NA      NA</span>
<span class="co">#&gt; 4        NA        NA       NA            NA            NA      NA      NA</span>
<span class="co">#&gt; 5        NA        NA       NA            NA            NA      NA      NA</span>
<span class="co">#&gt; 6  1.408828 0.9187022 1.107915          TRUE          TRUE   0.655   0.492</span>
<span class="co">#&gt;   method</span>
<span class="co">#&gt; 1   &lt;NA&gt;</span>
<span class="co">#&gt; 2   &lt;NA&gt;</span>
<span class="co">#&gt; 3   &lt;NA&gt;</span>
<span class="co">#&gt; 4   &lt;NA&gt;</span>
<span class="co">#&gt; 5   &lt;NA&gt;</span>
<span class="co">#&gt; 6     nm</span></code></pre></div>
<p>In this example, the point estimate of the indirect effect is 0.8968672, and the LBCI is 0.4265273 to 1.4640767.</p>
</div>
<div id="find-the-lbci-for-the-parameters-in-the-standardized-metric" class="section level2">
<h2 class="hasAnchor">
<a href="#find-the-lbci-for-the-parameters-in-the-standardized-metric" class="anchor"></a>Find the LBCI for the parameters in the standardized metric</h2>
<p>By the default, the unstandardized solution is used by <code><a href="../reference/semlbci.html">semlbci()</a></code>. If the LBCIs for the standardized solution solution are desired, set <code>standardized = TRUE</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/semlbci.html">semlbci</a></span><span class="op">(</span>sem_out <span class="op">=</span> <span class="va">fit</span>,
               pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y ~ m"</span>,
                        <span class="st">"m ~ x"</span><span class="op">)</span>,
               standardized <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">out</span>
<span class="co">#&gt;   lhs op rhs id   lbci_lb   est.std   lbci_ub status_lb status_ub ci_org_lb</span>
<span class="co">#&gt; 1   m  ~   x  1 0.1321680 0.2652599 0.3889569         0         0 0.1364211</span>
<span class="co">#&gt; 2   y  ~   m  2 0.3424299 0.4586934 0.5611206         0         0 0.3492624</span>
<span class="co">#&gt; 3   m ~~   m  3        NA 0.9296372        NA        NA        NA        NA</span>
<span class="co">#&gt; 4   y ~~   y  4        NA 0.7896003        NA        NA        NA        NA</span>
<span class="co">#&gt; 5   x ~~   x  5        NA 1.0000000        NA        NA        NA        NA</span>
<span class="co">#&gt; 6  ab := a*b  6        NA 0.1216730        NA        NA        NA        NA</span>
<span class="co">#&gt;   ci_org_ub ratio_lb  ratio_ub post_check_lb post_check_ub time_lb time_ub</span>
<span class="co">#&gt; 1 0.3940987 1.033011 0.9600913          TRUE          TRUE   1.820   1.787</span>
<span class="co">#&gt; 2 0.5681244 1.062437 0.9359975          TRUE          TRUE   3.974   4.195</span>
<span class="co">#&gt; 3        NA       NA        NA            NA            NA      NA      NA</span>
<span class="co">#&gt; 4        NA       NA        NA            NA            NA      NA      NA</span>
<span class="co">#&gt; 5        NA       NA        NA            NA            NA      NA      NA</span>
<span class="co">#&gt; 6        NA       NA        NA            NA            NA      NA      NA</span>
<span class="co">#&gt;   method</span>
<span class="co">#&gt; 1     nm</span>
<span class="co">#&gt; 2     nm</span>
<span class="co">#&gt; 3   &lt;NA&gt;</span>
<span class="co">#&gt; 4   &lt;NA&gt;</span>
<span class="co">#&gt; 5   &lt;NA&gt;</span>
<span class="co">#&gt; 6   &lt;NA&gt;</span></code></pre></div>
<p>The LBCIs for standardized user-defined parameters can be requested similarly.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/semlbci.html">semlbci</a></span><span class="op">(</span>sem_out <span class="op">=</span> <span class="va">fit</span>,
               pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ab :="</span><span class="op">)</span>,
               standardized <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">out</span>
<span class="co">#&gt;   lhs op rhs id    lbci_lb   est.std   lbci_ub status_lb status_ub  ci_org_lb</span>
<span class="co">#&gt; 1   m  ~   x  1         NA 0.2652599        NA        NA        NA         NA</span>
<span class="co">#&gt; 2   y  ~   m  2         NA 0.4586934        NA        NA        NA         NA</span>
<span class="co">#&gt; 3   m ~~   m  3         NA 0.9296372        NA        NA        NA         NA</span>
<span class="co">#&gt; 4   y ~~   y  4         NA 0.7896003        NA        NA        NA         NA</span>
<span class="co">#&gt; 5   x ~~   x  5         NA 1.0000000        NA        NA        NA         NA</span>
<span class="co">#&gt; 6  ab := a*b  6 0.05839293 0.1216730 0.1940194         0         0 0.05426493</span>
<span class="co">#&gt;   ci_org_ub  ratio_lb ratio_ub post_check_lb post_check_ub time_lb time_ub</span>
<span class="co">#&gt; 1        NA        NA       NA            NA            NA      NA      NA</span>
<span class="co">#&gt; 2        NA        NA       NA            NA            NA      NA      NA</span>
<span class="co">#&gt; 3        NA        NA       NA            NA            NA      NA      NA</span>
<span class="co">#&gt; 4        NA        NA       NA            NA            NA      NA      NA</span>
<span class="co">#&gt; 5        NA        NA       NA            NA            NA      NA      NA</span>
<span class="co">#&gt; 6  0.189081 0.9387611 1.073262          TRUE          TRUE   4.403   4.533</span>
<span class="co">#&gt;   method</span>
<span class="co">#&gt; 1   &lt;NA&gt;</span>
<span class="co">#&gt; 2   &lt;NA&gt;</span>
<span class="co">#&gt; 3   &lt;NA&gt;</span>
<span class="co">#&gt; 4   &lt;NA&gt;</span>
<span class="co">#&gt; 5   &lt;NA&gt;</span>
<span class="co">#&gt; 6     nm</span></code></pre></div>
<p>Note that it can be very slow when finding the LBCIs for standardized solution. In the above example, the time used to find the lower bound of the standardized indirect effect is 4.403 second(s), and that for the upper bound is 4.533 second(s). This is because several parameters are involved even for the standardized indirect effect with one mediator (six parameters: the variances of <code>x</code>, the error variances of <code>m</code> and <code>y</code>, the three unstandardized path coefficients <code>m ~ x</code>, <code>y ~ m</code>, and <code>y ~ x</code>).</p>
</div>
<div id="specify-the-coverage-probability-of-the-lbci" class="section level2">
<h2 class="hasAnchor">
<a href="#specify-the-coverage-probability-of-the-lbci" class="anchor"></a>Specify the coverage probability of the LBCI</h2>
<p>This can be done by setting <code>ciperc</code>. The default is .95.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/semlbci.html">semlbci</a></span><span class="op">(</span>sem_out <span class="op">=</span> <span class="va">fit</span>,
               pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"y ~ m"</span>,
                        <span class="st">"m ~ x"</span><span class="op">)</span>,
               ciperc <span class="op">=</span> <span class="fl">.99</span><span class="op">)</span>
<span class="va">out</span>
<span class="co">#&gt;   id lhs op rhs   lbci_lb        est   lbci_ub status_lb status_ub ci_org_lb</span>
<span class="co">#&gt; 1  1   m  ~   x 0.5571896  1.6761271 2.7950657         0         0 0.8317719</span>
<span class="co">#&gt; 2  2   y  ~   m 0.3447048  0.5350831 0.7254604         0         0 0.3914232</span>
<span class="co">#&gt; 3  3   m ~~   m        NA 34.7102956        NA        NA        NA        NA</span>
<span class="co">#&gt; 4  4   y ~~   y        NA 40.1189462        NA        NA        NA        NA</span>
<span class="co">#&gt; 5  5   x ~~   x        NA  0.9351346        NA        NA        NA        NA</span>
<span class="co">#&gt; 6  6  ab := a*b        NA  0.8968672        NA        NA        NA        NA</span>
<span class="co">#&gt;   ci_org_ub ratio_lb ratio_ub post_check_lb post_check_ub time_lb time_ub</span>
<span class="co">#&gt; 1 2.5204823 1.325198 1.325199          TRUE          TRUE   0.455   0.442</span>
<span class="co">#&gt; 2 0.6787429 1.325201 1.325195          TRUE          TRUE   0.445   0.448</span>
<span class="co">#&gt; 3        NA       NA       NA            NA            NA      NA      NA</span>
<span class="co">#&gt; 4        NA       NA       NA            NA            NA      NA      NA</span>
<span class="co">#&gt; 5        NA       NA       NA            NA            NA      NA      NA</span>
<span class="co">#&gt; 6        NA       NA       NA            NA            NA      NA      NA</span>
<span class="co">#&gt;   method</span>
<span class="co">#&gt; 1     nm</span>
<span class="co">#&gt; 2     nm</span>
<span class="co">#&gt; 3   &lt;NA&gt;</span>
<span class="co">#&gt; 4   &lt;NA&gt;</span>
<span class="co">#&gt; 5   &lt;NA&gt;</span>
<span class="co">#&gt; 6   &lt;NA&gt;</span></code></pre></div>
</div>
</div>
<div id="basic-arguments-in-semlbci" class="section level1">
<h1 class="hasAnchor">
<a href="#basic-arguments-in-semlbci" class="anchor"></a>Basic arguments in <code>semlbci()</code>
</h1>
<div id="sem_out-and-pars-the-fit-object-and-the-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#sem_out-and-pars-the-fit-object-and-the-parameters" class="anchor"></a><code>sem_out</code> and <code>pars</code>: The fit object and the parameters</h2>
<p>The only required argument for <code><a href="../reference/semlbci.html">semlbci()</a></code> is <code>sem_out</code>, the fit object from <code><a href="https://rdrr.io/pkg/lavaan/man/lavaan.html">lavaan::lavaan()</a></code> or its variants (e.g., <code>lavann::cfa()</code> and <code><a href="https://rdrr.io/pkg/lavaan/man/sem.html">lavaan::sem()</a></code>). By default, <code><a href="../reference/semlbci.html">semlbci()</a></code> will find the LBCIs for all free parameters and user-defined parameters, which can take a long time for a model with many parameters. Moreover, LBCI is usually used when Wald-type confidence interval may not be suitable, such as an indirect effect or a parameter in the standardized solution. These parameters may have sampling distributions that are asymmetric or otherwise substantially nonnormal due to bounded parameter spaces or other reasons.</p>
<p>Therefore, it is recommended to use <code><a href="../reference/semlbci.html">semlbci()</a></code> only for selected parameters. The argument <code>pars</code> should be a list of strings which specifies the parameters for which LBCIs will be formed (detailed below).</p>
<p>If time is not a concern, for example, when users want to explore the LBCIs for all free and user-defined parameters in a final model, then <code>pars</code> can be omitted to reques the LBCIs for all free and user-defined parameters (if any) in a model.</p>
</div>
<div id="ciperc-the-level-of-confidence" class="section level2">
<h2 class="hasAnchor">
<a href="#ciperc-the-level-of-confidence" class="anchor"></a><code>ciperc</code>: The level of confidence</h2>
<p>By default, the 95% LBCIs for the unstandardized solution will be formed. To change the level of confidence, set the argument <code>ciperc</code> to the desired coverage probability, e.g., .95 for 95%, .90 for 90%.</p>
</div>
<div id="standardized-whether-standardized-solution-is-used" class="section level2">
<h2 class="hasAnchor">
<a href="#standardized-whether-standardized-solution-is-used" class="anchor"></a><code>standardized</code>: Whether standardized solution is used</h2>
<p>By default, the LBCIs for the unstandardized solution will be formed. If the LBCIs for the standardized solution are desired, set <code>standardized = TRUE</code>. Note that it is much slower to find the LBCIs for the standardized solution than for the unstandardized solution.</p>
</div>
<div id="method-method-to-be-used-for-computing-the-lbcis" class="section level2">
<h2 class="hasAnchor">
<a href="#method-method-to-be-used-for-computing-the-lbcis" class="anchor"></a><code>method</code>: Method to be used for computing the LBCIs</h2>
<p>The method by Neale and Miller (1997) is used to search for the bounds. The method proposed by Wu and Neale (2012), though available if <code>method</code> is set to <code>"wn"</code>, should not be used because it is not fully tested. It was kept in the function as an experimental method.</p>
</div>
<div id="other-arguments" class="section level2">
<h2 class="hasAnchor">
<a href="#other-arguments" class="anchor"></a>Other arguments</h2>
<p>For detailed documentation of other argumetns, please refer to its help page, as well as the help page for <code><a href="../reference/ci_bound_nm_i.html">ci_bound_nm_i()</a></code> and <code><a href="../reference/ci_i.html">ci_i()</a></code>, the functions called by <code><a href="../reference/semlbci.html">semlbci()</a></code>.</p>
</div>
</div>
<div id="diagnostic-information" class="section level1">
<h1 class="hasAnchor">
<a href="#diagnostic-information" class="anchor"></a>Diagnostic information</h1>
<p>Columns with diagnostic information will always be appended to the output of <code><a href="../reference/semlbci.html">semlbci()</a></code>. This feature cannot be turned off because we believe it is important to check the diagnostic information to see if there are any anomalies in the search. Unlike Wald-type CIs, LBCIs are searched by optimization rather than by closed-form equations. It is possible that the bounds are difficult to find for some situations.</p>
<div id="status_lb-and-status_ub" class="section level2">
<h2 class="hasAnchor">
<a href="#status_lb-and-status_ub" class="anchor"></a><code>status_lb</code> and <code>status_ub</code>
</h2>
<p>These two columns store the status codes in searching for the lower bound and the upper bound, respectively. If the status code is equal to zero, then the optimization should be fine. Any value other than zero indicates one or more issues in the optimization. Users are recommended to examine other columns, such as <code>post_check_lb</code> and <code>post_check_ub</code>. Detailed information on the search can be requested by setting <code>verbose = TRUE</code>. Additional diagnostic information can then be retrieved by inspecting the attributes <code>lb_diag</code> or <code>ub_diag</code> (e.g., <code><a href="https://rdrr.io/r/base/attr.html">attr(out, "lb_diag")</a></code> in the example above) for the probable reason of the non-zero status code.</p>
</div>
<div id="ci_org_lb-and-ci_org_ub" class="section level2">
<h2 class="hasAnchor">
<a href="#ci_org_lb-and-ci_org_ub" class="anchor"></a><code>ci_org_lb</code> and <code>ci_org_ub</code>
</h2>
<p>The confidence intervals computed by <code>lavaan</code>. These are the same confidence intervals returned by <code>lavaan::ParameterEstimates()</code> or <code>lavaan::StandardizedSolution()</code> for the fit object specified in <code>sem_out</code>. These intervals are included in the output for comparison.</p>
</div>
<div id="ratio_lb-and-ratio_ub" class="section level2">
<h2 class="hasAnchor">
<a href="#ratio_lb-and-ratio_ub" class="anchor"></a><code>ratio_lb</code> and <code>ratio_ub</code>
</h2>
<p>The ratio of the distance from a LBCI bound to the point estimates to that from the corresponding <code>lavaan</code> confidence bound to the same point estimates, sign ignored. This ratio is not expected to be zero. However, if the ratio is too large or too small, users should decide whether it is usual based on the nature of the parameters. The optional argument <code>ci_limit_ratio_tol</code> in <code><a href="../reference/semlbci.html">semlbci()</a></code> (documented in <code><a href="../reference/ci_bound_nm_i.html">ci_bound_nm_i()</a></code> and <code><a href="../reference/ci_bound_i.html">ci_bound_i()</a></code>) sets the threshold for alerting the users. If the ratio is larger than this threshold (defualt 1.5), the status code will be set to a non-zero value.</p>
</div>
<div id="post_check_lb-and-post_check_ub" class="section level2">
<h2 class="hasAnchor">
<a href="#post_check_lb-and-post_check_ub" class="anchor"></a><code>post_check_lb</code> and <code>post_check_ub</code>
</h2>
<p>These two columns indicate whether the solution at the boundary found passes the check conducted by <code><a href="https://rdrr.io/pkg/lavaan/man/lavInspect.html">lavaan::lavInspect()</a></code> with argument set to <code>post.check</code>. If <code>FALSE</code> for a bound, the bound should not be trusted.</p>
</div>
<div id="time_lb-and-time_ub" class="section level2">
<h2 class="hasAnchor">
<a href="#time_lb-and-time_ub" class="anchor"></a><code>time_lb</code> and <code>time_ub</code>
</h2>
<p>The time, in second, used to search for each bound. It can serve as an estimate for rerunning the search. It also reflects how difficult it is to find the solution for a bound.</p>
</div>
<div id="method" class="section level2">
<h2 class="hasAnchor">
<a href="#method" class="anchor"></a><code>method</code>
</h2>
<p>The method used to search a bound. It should only have the value <code>"nm"</code>, the Neale-Miller-1997 method (see the limitation below on method).</p>
</div>
</div>
<div id="limitations" class="section level1">
<h1 class="hasAnchor">
<a href="#limitations" class="anchor"></a>Limitations</h1>
<p>The following is a summary of the limitations of <code><a href="../reference/semlbci.html">semlbci()</a></code>. Please refer to <code><a href="../reference/check_sem_out.html">check_sem_out()</a></code> for the full list of limitations. This function is called by <code><a href="../reference/semlbci.html">semlbci()</a></code> to check the <code>sem_out</code> object, and will raise warnings or errors as appropriate.</p>
<div id="estimators" class="section level2">
<h2 class="hasAnchor">
<a href="#estimators" class="anchor"></a>Estimators</h2>
<p>The function <code><a href="../reference/semlbci.html">semlbci()</a></code> currently supports <code><a href="https://rdrr.io/pkg/lavaan/man/lavaan.html">lavaan::lavaan()</a></code> results estimated by maximum likelihood (<code>ML</code>), full information maximum likelihood for missing data (<code>fiml</code>), generalized least squares (<code>GLS</code>), and weighted least squares (a.k.a. asymptotically distribution free) (<code>WLS</code>).</p>
</div>
<div id="models" class="section level2">
<h2 class="hasAnchor">
<a href="#models" class="anchor"></a>Models</h2>
<p>Officially, this package currently supports single group models with continuous variables. It <em>may</em> work for multiple group models but it has not been tested for these models.</p>
</div>
<div id="methods" class="section level2">
<h2 class="hasAnchor">
<a href="#methods" class="anchor"></a>Methods</h2>
<p>The current and preferred method is the one proposed by Neale and Miller (1997). The current implementation in <code><a href="../reference/semlbci.html">semlbci()</a></code> does not check whether a parameter is near its boundary. The more advanced methods by Pritikin, Rappaport, and Neale (2017) will be considered in future development.</p>
<p>The method proposed by Wu and Neale (2012, see also Pek and Wu, 2015) was the first method we tried in developing <code><a href="../reference/semlbci.html">semlbci()</a></code>. This method is very easy to implement but turned out to be much lower than the Neale-Miller-1997 method for unknown reasons. Moreover, prelminary tests also found that our implementation of this method failed when the population value of a parameter is close to its boundary (e.g., a correlation close to one). Therefore, the Neale-Miller-1997 method, though more difficult to implement, is now the default. The Wu-Neale-2012 method remained in the code for experimental purpose and may be revised in future development.</p>
</div>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<p>Neale, M. C., &amp; Miller, M. B. (1997). The use of likelihood-based confidence intervals in genetic models. <em>Behavior Genetics, 27</em>(2), 113–120.</p>
<p>Pek, J., &amp; Wu, H. (2015). Profile likelihood-based confidence intervals and regions for structural equation models. <em>Psychometrika, 80</em>(4), 1123–1145. <a href="https://doi.org/10.1007/s11336-015-9461-1" class="uri">https://doi.org/10.1007/s11336-015-9461-1</a></p>
<p>Pritikin, J. N., Rappaport, L. M., &amp; Neale, M. C. (2017). Likelihood-based confidence intervals for a parameter with an upper or lower bound. <em>Structural Equation Modeling: A Multidisciplinary Journal, 24</em>(3), 395-401. <a href="https://doi.org/10.1080/10705511.2016.1275969" class="uri">https://doi.org/10.1080/10705511.2016.1275969</a></p>
<p>Wu, H., &amp; Neale, M. C. (2012). Adjusted confidence intervals for a bounded parameter. <em>Behavior Genetics, 42</em>(6), 886–898. <a href="https://doi.org/10.1007/s10519-012-9560-z" class="uri">https://doi.org/10.1007/s10519-012-9560-z</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Shu Fai Cheung.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
