<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quick Start â€¢ semlbci</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Quick Start">
<meta property="og:description" content="semlbci">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">semlbci</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.10</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/semlbci.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="semlbci_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Quick Start</h1>
                        <h4 data-toc-skip class="author">Shu Fai Cheung</h4>
            
            <h4 data-toc-skip class="date">2022-05-17</h4>
      
      
      <div class="hidden name"><code>semlbci.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">semlbci</span><span class="op">)</span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This package includes functions for finding the likelihood based confidence intervals (LBCIs) of parameters in the output of a structural equation modeling (SEM) function. Currently, it supports the output from <code><a href="https://rdrr.io/pkg/lavaan/man/lavaan.html" class="external-link">lavaan::lavaan()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="fit-a-model-to-a-dataset">Fit a model to a dataset<a class="anchor" aria-label="anchor" href="#fit-a-model-to-a-dataset"></a>
</h2>
<p>The package has a dataset, <code>simple_med</code>, with three variables, <code>x</code>, <code>m</code>, and <code>y</code>. Let us fit a simple mediation model to this datast.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">simple_med</span><span class="op">)</span>
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">simple_med</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>
<span class="co">#&gt;            x          m         y</span>
<span class="co">#&gt; 1 -0.3447375   7.284273 -5.636897</span>
<span class="co">#&gt; 2 -0.3658919  -5.449121 -4.525402</span>
<span class="co">#&gt; 3 -0.8294968  -7.016254 -7.823257</span>
<span class="co">#&gt; 4 -0.3389654   4.367018  1.563098</span>
<span class="co">#&gt; 5 -0.9628162  -4.015469 -7.288511</span>
<span class="co">#&gt; 6 -1.0749302 -11.538140 -4.153572</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be" class="external-link">lavaan</a></span><span class="op">)</span>
<span class="co">#&gt; This is lavaan 0.6-11</span>
<span class="co">#&gt; lavaan is FREE software! Please report any bugs.</span>
<span class="va">mod</span> <span class="op">&lt;-</span>
<span class="st">"
m ~ a*x
y ~ b*m
ab := a * b
"</span>
<span class="co"># We set fixed.x = FALSE because we will also find the LBCIs for</span>
<span class="co"># standardized solution</span>
<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">sem</a></span><span class="op">(</span><span class="va">mod</span>, <span class="va">simple_med</span>, fixed.x <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>If we want to find the LBCIs for standardized solution, we usually should also treat the exogenous variables as random variables such that the sampling error in estimating their variances and covariances will be taken into account.</p>
<p>To illustrate how to find the LBCIs for user-defined parameters, we labelled the <code>m ~ x</code> path by <code>a</code>, the <code>y ~ m</code> path by <code>b</code>, and defined the indirect effect, <code>ab</code>, by <code>a * b</code>.</p>
<p>This is the summary:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span>, standardized <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; lavaan 0.6-11 ended normally after 1 iterations</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Estimator                                         ML</span>
<span class="co">#&gt;   Optimization method                           NLMINB</span>
<span class="co">#&gt;   Number of model parameters                         5</span>
<span class="co">#&gt;                                                       </span>
<span class="co">#&gt;   Number of observations                           200</span>
<span class="co">#&gt;                                                       </span>
<span class="co">#&gt; Model Test User Model:</span>
<span class="co">#&gt;                                                       </span>
<span class="co">#&gt;   Test statistic                                10.549</span>
<span class="co">#&gt;   Degrees of freedom                                 1</span>
<span class="co">#&gt;   P-value (Chi-square)                           0.001</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Parameter Estimates:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   Standard errors                             Standard</span>
<span class="co">#&gt;   Information                                 Expected</span>
<span class="co">#&gt;   Information saturated (h1) model          Structured</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Regressions:</span>
<span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span>
<span class="co">#&gt;   m ~                                                                   </span>
<span class="co">#&gt;     x          (a)    1.676    0.431    3.891    0.000    1.676    0.265</span>
<span class="co">#&gt;   y ~                                                                   </span>
<span class="co">#&gt;     m          (b)    0.535    0.073    7.300    0.000    0.535    0.459</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Variances:</span>
<span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span>
<span class="co">#&gt;    .m                34.710    3.471   10.000    0.000   34.710    0.930</span>
<span class="co">#&gt;    .y                40.119    4.012   10.000    0.000   40.119    0.790</span>
<span class="co">#&gt;     x                 0.935    0.094   10.000    0.000    0.935    1.000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Defined Parameters:</span>
<span class="co">#&gt;                    Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all</span>
<span class="co">#&gt;     ab                0.897    0.261    3.434    0.001    0.897    0.122</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="exmaples">Exmaples<a class="anchor" aria-label="anchor" href="#exmaples"></a>
</h2>
<p>The main function to find the LBCIs for free parameters is <code><a href="../reference/semlbci.html">semlbci()</a></code>. This should be the only function used by normal users. We will first illustrate its usage by some examples, and then present other technical details in the following section.</p>
<div class="section level3">
<h3 id="find-the-lbci-for-a-free-parameter">Find the LBCI for a free parameter<a class="anchor" aria-label="anchor" href="#find-the-lbci-for-a-free-parameter"></a>
</h3>
<p>All free parameters can be specified in <code>lavaan</code> style. For example, the path from <code>m</code> to <code>y</code> is denoted by <code>"y ~ m"</code>, and the covariance or correlation between <code>x</code> and <code>m</code> (not in the example) is denoted by <code>"x ~~ m"</code> (order does not matter).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/semlbci.html">semlbci</a></span><span class="op">(</span>sem_out <span class="op">=</span> <span class="va">fit</span>,
               pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y ~ m"</span>,
                        <span class="st">"m ~ x"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The output is the parameter table of the fitted <code>lavaan</code> object, with two columns added, <code>lbci_lb</code> and <code>lbci_ub</code>, the likelihood-based lower bounds and upper bounds, respectively. The column of point estimates in the fit object is positioned between these two columns of bounds. Diagnostic information will also be appended to the output (described in details below).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Results:</span>
<span class="co">#&gt;   id lhs op rhs label    lb   est    ub wald_l wald_u cl_lb cl_ub</span>
<span class="co">#&gt; 1  1   m  ~   x     a 0.828 1.676 2.525  0.832  2.520  0.95  0.95</span>
<span class="co">#&gt; 2  2   y  ~   m     b 0.391 0.535 0.679  0.391  0.679  0.95  0.95</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Annotation:</span>
<span class="co">#&gt; * lb, ub: The lower and upper likehood-based limits.</span>
<span class="co">#&gt; * est: The point estimates from the original lavaan output</span>
<span class="co">#&gt; * wald_l, wald_u: The lower and upper Wald limits, extracted from the</span>
<span class="co">#&gt;     original lavaan output.</span>
<span class="co">#&gt; * cl_lb, cl_ub: The achieved level of confidence of the bound, computed</span>
<span class="co">#&gt;     from the chi-square difference test. Should be close to the</span>
<span class="co">#&gt;     requested level of confidence.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; semlbci(sem_out = fit, pars = c("y ~ m", "m ~ x"))</span></code></pre></div>
<p>In this example, the point estimate of the unstandardized coefficient from <code>x</code> to <code>m</code> is 1.6761276, and the LBCI is 0.8277016 to 2.5245537.</p>
</div>
<div class="section level3">
<h3 id="find-the-lbci-for-a-user-defined-parameter">Find the LBCI for a user-defined parameter<a class="anchor" aria-label="anchor" href="#find-the-lbci-for-a-user-defined-parameter"></a>
</h3>
<p>To find the LBCI for a user-defined parameter, use <code>label :=</code>, where <code>label</code> is the label used in the model specification. The definition of this parameter can be omitted. The content after <code>:=</code> will be ignored by <code><a href="../reference/semlbci.html">semlbci()</a></code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/semlbci.html">semlbci</a></span><span class="op">(</span>sem_out <span class="op">=</span> <span class="va">fit</span>,
               pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ab := "</span><span class="op">)</span><span class="op">)</span>
<span class="va">out</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Results:</span>
<span class="co">#&gt;   id lhs op rhs label    lb   est    ub wald_l wald_u cl_lb cl_ub</span>
<span class="co">#&gt; 6  6  ab := a*b    ab 0.427 0.897 1.464  0.385  1.409  0.95  0.95</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Annotation:</span>
<span class="co">#&gt; * lb, ub: The lower and upper likehood-based limits.</span>
<span class="co">#&gt; * est: The point estimates from the original lavaan output</span>
<span class="co">#&gt; * wald_l, wald_u: The lower and upper Wald limits, extracted from the</span>
<span class="co">#&gt;     original lavaan output.</span>
<span class="co">#&gt; * cl_lb, cl_ub: The achieved level of confidence of the bound, computed</span>
<span class="co">#&gt;     from the chi-square difference test. Should be close to the</span>
<span class="co">#&gt;     requested level of confidence.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; semlbci(sem_out = fit, pars = c("ab := "))</span></code></pre></div>
<p>In this example, the point estimate of the indirect effect is 0.8968668, and the LBCI is 0.4265275 to 1.4640769.</p>
</div>
<div class="section level3">
<h3 id="find-the-lbci-for-the-parameters-in-the-standardized-metric">Find the LBCI for the parameters in the standardized metric<a class="anchor" aria-label="anchor" href="#find-the-lbci-for-the-parameters-in-the-standardized-metric"></a>
</h3>
<p>By the default, the unstandardized solution is used by <code><a href="../reference/semlbci.html">semlbci()</a></code>. If the LBCIs for the standardized solution solution are desired, set <code>standardized = TRUE</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/semlbci.html">semlbci</a></span><span class="op">(</span>sem_out <span class="op">=</span> <span class="va">fit</span>,
               pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y ~ m"</span>,
                        <span class="st">"m ~ x"</span><span class="op">)</span>,
               standardized <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">out</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Results:</span>
<span class="co">#&gt;   lhs op rhs id label    lb   est.std    ub wald_l wald_u cl_lb cl_ub   est</span>
<span class="co">#&gt; 1   m  ~   x  1     a 0.132 0.2652600 0.389  0.136  0.394  0.95  0.95 0.265</span>
<span class="co">#&gt; 2   y  ~   m  2     b 0.342 0.4586931 0.561  0.349  0.568  0.95  0.95 0.459</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Annotation:</span>
<span class="co">#&gt; * lb, ub: The lower and upper likehood-based limits.</span>
<span class="co">#&gt; * est: The point estimates from the original lavaan output</span>
<span class="co">#&gt; * wald_l, wald_u: The lower and upper Wald limits, extracted from the</span>
<span class="co">#&gt;     original lavaan output.</span>
<span class="co">#&gt; * cl_lb, cl_ub: The achieved level of confidence of the bound, computed</span>
<span class="co">#&gt;     from the chi-square difference test. Should be close to the</span>
<span class="co">#&gt;     requested level of confidence.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; semlbci(sem_out = fit, pars = c("y ~ m", "m ~ x"), standardized = TRUE)</span></code></pre></div>
<p>The LBCIs for standardized user-defined parameters can be requested similarly.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/semlbci.html">semlbci</a></span><span class="op">(</span>sem_out <span class="op">=</span> <span class="va">fit</span>,
               pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ab :="</span><span class="op">)</span>,
               standardized <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">out</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Results:</span>
<span class="co">#&gt;   lhs op rhs id label    lb   est.std    ub wald_l wald_u cl_lb cl_ub   est</span>
<span class="co">#&gt; 6  ab := a*b  6    ab 0.058 0.1216729 0.194  0.054  0.189  0.95  0.95 0.122</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Annotation:</span>
<span class="co">#&gt; * lb, ub: The lower and upper likehood-based limits.</span>
<span class="co">#&gt; * est: The point estimates from the original lavaan output</span>
<span class="co">#&gt; * wald_l, wald_u: The lower and upper Wald limits, extracted from the</span>
<span class="co">#&gt;     original lavaan output.</span>
<span class="co">#&gt; * cl_lb, cl_ub: The achieved level of confidence of the bound, computed</span>
<span class="co">#&gt;     from the chi-square difference test. Should be close to the</span>
<span class="co">#&gt;     requested level of confidence.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; semlbci(sem_out = fit, pars = c("ab :="), standardized = TRUE)</span></code></pre></div>
<p>Note that it can be very slow when finding the LBCIs for standardized solution. In the above example, the time used to find the lower bound of the standardized indirect effect is 1.661 second(s), and that for the upper bound is 1.692 second(s). This is because several parameters are involved even for the standardized indirect effect with one mediator (six parameters: the variances of <code>x</code>, the error variances of <code>m</code> and <code>y</code>, the three unstandardized path coefficients <code>m ~ x</code>, <code>y ~ m</code>, and <code>y ~ x</code>).</p>
</div>
<div class="section level3">
<h3 id="specify-the-coverage-probability-of-the-lbci">Specify the coverage probability of the LBCI<a class="anchor" aria-label="anchor" href="#specify-the-coverage-probability-of-the-lbci"></a>
</h3>
<p>This can be done by setting <code>ciperc</code>. The default is .95.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/semlbci.html">semlbci</a></span><span class="op">(</span>sem_out <span class="op">=</span> <span class="va">fit</span>,
               pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"y ~ m"</span>,
                        <span class="st">"m ~ x"</span><span class="op">)</span>,
               ciperc <span class="op">=</span> <span class="fl">.99</span><span class="op">)</span>
<span class="va">out</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Results:</span>
<span class="co">#&gt;   id lhs op rhs label    lb   est    ub wald_l wald_u cl_lb cl_ub</span>
<span class="co">#&gt; 1  1   m  ~   x     a 0.557 1.676 2.795  0.566  2.786  0.99  0.99</span>
<span class="co">#&gt; 2  2   y  ~   m     b 0.345 0.535 0.725  0.346  0.724  0.99  0.99</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Annotation:</span>
<span class="co">#&gt; * lb, ub: The lower and upper likehood-based limits.</span>
<span class="co">#&gt; * est: The point estimates from the original lavaan output</span>
<span class="co">#&gt; * wald_l, wald_u: The lower and upper Wald limits, extracted from the</span>
<span class="co">#&gt;     original lavaan output.</span>
<span class="co">#&gt; * cl_lb, cl_ub: The achieved level of confidence of the bound, computed</span>
<span class="co">#&gt;     from the chi-square difference test. Should be close to the</span>
<span class="co">#&gt;     requested level of confidence.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; semlbci(sem_out = fit, pars = c("y ~ m", "m ~ x"), ciperc = 0.99)</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="basic-arguments-in-semlbci">Basic arguments in <code>semlbci()</code><a class="anchor" aria-label="anchor" href="#basic-arguments-in-semlbci"></a>
</h2>
<div class="section level3">
<h3 id="sem_out-and-pars-the-fit-object-and-the-parameters">
<code>sem_out</code> and <code>pars</code>: The fit object and the parameters<a class="anchor" aria-label="anchor" href="#sem_out-and-pars-the-fit-object-and-the-parameters"></a>
</h3>
<p>The only required argument for <code><a href="../reference/semlbci.html">semlbci()</a></code> is <code>sem_out</code>, the fit object from <code><a href="https://rdrr.io/pkg/lavaan/man/lavaan.html" class="external-link">lavaan::lavaan()</a></code> or its variants (e.g., <code>lavann::cfa()</code> and <code><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">lavaan::sem()</a></code>). By default, <code><a href="../reference/semlbci.html">semlbci()</a></code> will find the LBCIs for all free parameters and user-defined parameters, which can take a long time for a model with many parameters. Moreover, LBCI is usually used when Wald-type confidence interval may not be suitable, such as an indirect effect or a parameter in the standardized solution. These parameters may have sampling distributions that are asymmetric or otherwise substantially nonnormal due to bounded parameter spaces or other reasons.</p>
<p>Therefore, it is recommended to use <code><a href="../reference/semlbci.html">semlbci()</a></code> only for selected parameters. The argument <code>pars</code> should be a list of strings which specifies the parameters for which LBCIs will be formed (detailed below).</p>
<p>If time is not a concern, for example, when users want to explore the LBCIs for all free and user-defined parameters in a final model, then <code>pars</code> can be omitted to reques the LBCIs for all free and user-defined parameters (if any) in a model.</p>
</div>
<div class="section level3">
<h3 id="ciperc-the-level-of-confidence">
<code>ciperc</code>: The level of confidence<a class="anchor" aria-label="anchor" href="#ciperc-the-level-of-confidence"></a>
</h3>
<p>By default, the 95% LBCIs for the unstandardized solution will be formed. To change the level of confidence, set the argument <code>ciperc</code> to the desired coverage probability, e.g., .95 for 95%, .90 for 90%.</p>
</div>
<div class="section level3">
<h3 id="standardized-whether-standardized-solution-is-used">
<code>standardized</code>: Whether standardized solution is used<a class="anchor" aria-label="anchor" href="#standardized-whether-standardized-solution-is-used"></a>
</h3>
<p>By default, the LBCIs for the unstandardized solution will be formed. If the LBCIs for the standardized solution are desired, set <code>standardized = TRUE</code>. Note that it is much slower to find the LBCIs for the standardized solution than for the unstandardized solution.</p>
</div>
<div class="section level3">
<h3 id="method-method-to-be-used-for-computing-the-lbcis">
<code>method</code>: Method to be used for computing the LBCIs<a class="anchor" aria-label="anchor" href="#method-method-to-be-used-for-computing-the-lbcis"></a>
</h3>
<p>The method used to search a bound. Currently only support <code>"wn"</code> (the method proposed by Wu &amp; Neale, 2012).</p>
</div>
<div class="section level3">
<h3 id="other-arguments">Other arguments<a class="anchor" aria-label="anchor" href="#other-arguments"></a>
</h3>
<p>For detailed documentation of other argumetns, please refer to its help page, as well as the help page for <code><a href="../reference/ci_bound_wn_i.html">ci_bound_wn_i()</a></code> and <code><a href="../reference/ci_i_one.html">ci_i_one()</a></code>, the functions called by <code><a href="../reference/semlbci.html">semlbci()</a></code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="diagnostic-information">Diagnostic information<a class="anchor" aria-label="anchor" href="#diagnostic-information"></a>
</h2>
<p>Columns with diagnostic information will always be appended to the output of <code><a href="../reference/semlbci.html">semlbci()</a></code>. This feature cannot be turned off because we believe it is important to check the diagnostic information to see if there are any anomalies in the search. Unlike Wald-type CIs, LBCIs are searched by optimization rather than by closed-form equations. It is possible that the bounds are difficult to find for some situations.</p>
<div class="section level3">
<h3 id="status_lb-and-status_ub">
<code>status_lb</code> and <code>status_ub</code><a class="anchor" aria-label="anchor" href="#status_lb-and-status_ub"></a>
</h3>
<p>These two columns store the status codes in searching for the lower bound and the upper bound, respectively. If the status code is equal to zero, then the optimization should be fine. Any value other than zero indicates one or more issues in the optimization. Users are recommended to examine other columns, such as <code>post_check_lb</code> and <code>post_check_ub</code>. Detailed information on the search can be requested by setting <code>verbose = TRUE</code>. Additional diagnostic information can then be retrieved by inspecting the attributes <code>lb_diag</code> or <code>ub_diag</code> (e.g., <code>attr(out, "lb_diag")</code> in the example above) for the probable reason of the non-zero status code.</p>
</div>
<div class="section level3">
<h3 id="ci_org_lb-and-ci_org_ub">
<code>ci_org_lb</code> and <code>ci_org_ub</code><a class="anchor" aria-label="anchor" href="#ci_org_lb-and-ci_org_ub"></a>
</h3>
<p>The confidence intervals computed by <code>lavaan</code>. These are the same confidence intervals returned by <code>lavaan::ParameterEstimates()</code> or <code>lavaan::StandardizedSolution()</code> for the fit object specified in <code>sem_out</code>. These intervals are included in the output for comparison.</p>
</div>
<div class="section level3">
<h3 id="ratio_lb-and-ratio_ub">
<code>ratio_lb</code> and <code>ratio_ub</code><a class="anchor" aria-label="anchor" href="#ratio_lb-and-ratio_ub"></a>
</h3>
<p>The ratio of the distance from a LBCI bound to the point estimates to that from the corresponding <code>lavaan</code> confidence bound to the same point estimates, sign ignored. This ratio is not expected to be zero. However, if the ratio is too large or too small, users should decide whether it is usual based on the nature of the parameters. The optional argument <code>ci_limit_ratio_tol</code> in <code><a href="../reference/semlbci.html">semlbci()</a></code> (documented in <code><a href="../reference/ci_bound_wn_i.html">ci_bound_wn_i()</a></code>) sets the threshold for alerting the users. If the ratio is larger than this threshold (defualt 1.5), the status code will be set to a non-zero value.</p>
</div>
<div class="section level3">
<h3 id="post_check_lb-and-post_check_ub">
<code>post_check_lb</code> and <code>post_check_ub</code><a class="anchor" aria-label="anchor" href="#post_check_lb-and-post_check_ub"></a>
</h3>
<p>These two columns indicate whether the solution at the boundary found passes the check conducted by <code><a href="https://rdrr.io/pkg/lavaan/man/lavInspect.html" class="external-link">lavaan::lavInspect()</a></code> with argument set to <code>post.check</code>. If <code>FALSE</code> for a bound, the bound should not be trusted.</p>
</div>
<div class="section level3">
<h3 id="time_lb-and-time_ub">
<code>time_lb</code> and <code>time_ub</code><a class="anchor" aria-label="anchor" href="#time_lb-and-time_ub"></a>
</h3>
<p>The time, in second, used to search for each bound. It can serve as an estimate for rerunning the search. It also reflects how difficult it is to find the solution for a bound.</p>
</div>
<div class="section level3">
<h3 id="method">
<code>method</code><a class="anchor" aria-label="anchor" href="#method"></a>
</h3>
<p>The method used to search a bound. Currently only support <code>"wn"</code> (the method proposed by Wu &amp; Neale, 2012).</p>
</div>
</div>
<div class="section level2">
<h2 id="limitations">Limitations<a class="anchor" aria-label="anchor" href="#limitations"></a>
</h2>
<p>The following is a summary of the limitations of <code><a href="../reference/semlbci.html">semlbci()</a></code>. Please refer to <code><a href="../reference/check_sem_out.html">check_sem_out()</a></code> for the full list of limitations. This function is called by <code><a href="../reference/semlbci.html">semlbci()</a></code> to check the <code>sem_out</code> object, and will raise warnings or errors as appropriate.</p>
<div class="section level3">
<h3 id="estimators">Estimators<a class="anchor" aria-label="anchor" href="#estimators"></a>
</h3>
<p>The function <code><a href="../reference/semlbci.html">semlbci()</a></code> currently supports <code><a href="https://rdrr.io/pkg/lavaan/man/lavaan.html" class="external-link">lavaan::lavaan()</a></code> results estimated by maximum likelihood (<code>ML</code>), full information maximum likelihood for missing data (<code>fiml</code>), generalized least squares (<code>GLS</code>), and weighted least squares (a.k.a. asymptotically distribution free) (<code>WLS</code>).</p>
</div>
<div class="section level3">
<h3 id="models">Models<a class="anchor" aria-label="anchor" href="#models"></a>
</h3>
<p>Officially, this package currently supports single group models with continuous variables. It <em>may</em> work for multiple group models but it has not been tested for these models.</p>
</div>
<div class="section level3">
<h3 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a>
</h3>
<p>The current and preferred method is the one proposed by Wu and Neale (2012). The current implementation in <code><a href="../reference/semlbci.html">semlbci()</a></code> does not check whether a parameter is near its boundary. The more advanced methods by Pritikin, Rappaport, and Neale (2017) will be considered in future development. The method by Neale and Miller (1997, <code>"nm"</code> <code><a href="../reference/semlbci.html">semlbci()</a></code>) was also attempted but only tested in a few simple scenarios.</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Neale, M. C., &amp; Miller, M. B. (1997). The use of likelihood-based confidence intervals in genetic models. <em>Behavior Genetics, 27</em>(2), 113â€“120.</p>
<p>Pek, J., &amp; Wu, H. (2015). Profile likelihood-based confidence intervals and regions for structural equation models. <em>Psychometrika, 80</em>(4), 1123â€“1145. <a href="https://doi.org/10.1007/s11336-015-9461-1" class="external-link uri">https://doi.org/10.1007/s11336-015-9461-1</a></p>
<p>Pritikin, J. N., Rappaport, L. M., &amp; Neale, M. C. (2017). Likelihood-based confidence intervals for a parameter with an upper or lower bound. <em>Structural Equation Modeling: A Multidisciplinary Journal, 24</em>(3), 395-401. <a href="https://doi.org/10.1080/10705511.2016.1275969" class="external-link uri">https://doi.org/10.1080/10705511.2016.1275969</a></p>
<p>Wu, H., &amp; Neale, M. C. (2012). Adjusted confidence intervals for a bounded parameter. <em>Behavior Genetics, 42</em>(6), 886â€“898. <a href="https://doi.org/10.1007/s10519-012-9560-z" class="external-link uri">https://doi.org/10.1007/s10519-012-9560-z</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Shu Fai Cheung.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
