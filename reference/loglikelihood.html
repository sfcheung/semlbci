<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Log Profile likelihood of a Parameter — loglike_range • semlbci</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Log Profile likelihood of a Parameter — loglike_range"><meta property="og:description" content="These functions compute the log profile likelihood of
a parameter when it is fixed to a value or a range of values"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">semlbci</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.10.0.12</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/semlbci.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Log Profile likelihood of a Parameter</h1>
    
    <div class="hidden name"><code>loglikelihood.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>These functions compute the log profile likelihood of
a parameter when it is fixed to a value or a range of values</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">loglike_range</span><span class="op">(</span></span>
<span>  <span class="va">sem_out</span>,</span>
<span>  <span class="va">par_i</span>,</span>
<span>  confidence <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  n_points <span class="op">=</span> <span class="fl">21</span>,</span>
<span>  interval <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  start <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  try_k_more <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ncpus <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span>logical <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>  use_pbapply <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">loglike_point</span><span class="op">(</span></span>
<span>  <span class="va">theta0</span>,</span>
<span>  <span class="va">sem_out</span>,</span>
<span>  <span class="va">par_i</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  start <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  try_k_more <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">loglike_quad_range</span><span class="op">(</span></span>
<span>  <span class="va">sem_out</span>,</span>
<span>  <span class="va">par_i</span>,</span>
<span>  confidence <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  n_points <span class="op">=</span> <span class="fl">21</span>,</span>
<span>  interval <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ncpus <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span>logical <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>  use_pbapply <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  try_k_more <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  start <span class="op">=</span> <span class="st">"default"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">loglike_quad_point</span><span class="op">(</span><span class="va">theta0</span>, <span class="va">sem_out</span>, <span class="va">par_i</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">loglike_compare</span><span class="op">(</span></span>
<span>  <span class="va">sem_out</span>,</span>
<span>  <span class="va">par_i</span>,</span>
<span>  confidence <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  n_points <span class="op">=</span> <span class="fl">21</span>,</span>
<span>  start <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  try_k_more <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ncpus <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span>logical <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>  use_pbapply <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>sem_out</dt>
<dd><p>The SEM output. Currently the outputs
of <code><a href="https://rdrr.io/pkg/lavaan/man/lavaan.html" class="external-link">lavaan::lavaan()</a></code> or its wrappers, such as <code><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">lavaan::sem()</a></code>
and <code><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">lavaan::cfa()</a></code> are supported.</p></dd>


<dt>par_i</dt>
<dd><p>The row number of the parameter in the output of
<code><a href="https://rdrr.io/pkg/lavaan/man/model.syntax.html" class="external-link">lavaan::parameterTable()</a></code>. Can also be a <a href="https://rdrr.io/pkg/lavaan/man/model.syntax.html" class="external-link">lavaan::model.syntax</a>
specification for a parameter, e.g., <code>"y ~ x"</code> or <code>ab := </code>.
It will be converted to the row number by <code><a href="syntax_to_i.html">syntax_to_i()</a></code>. Refer to
<code><a href="syntax_to_i.html">syntax_to_i()</a></code> for details.</p></dd>


<dt>confidence</dt>
<dd><p>The level of confidence of the Wald-type
confidence interval. If <code>interval</code> is <code>NULL</code>, this confidence is
used to form the interval.</p></dd>


<dt>n_points</dt>
<dd><p>The number of points to be evaluated in the
interval. Default is 21.</p></dd>


<dt>interval</dt>
<dd><p>A vector of numbers. If provided and has two
elements, this will be used as the end points of the interval. If
it has more than two elements, the elements will be used directly
to form the values in the interval. Default is <code>NULL</code>.</p></dd>


<dt>verbose</dt>
<dd><p>Whether some diagnostic information will be printed.
Default is <code>FALSE</code>.</p></dd>


<dt>start</dt>
<dd><p>How the start values are set in <code><a href="https://rdrr.io/pkg/lavaan/man/lavaan.html" class="external-link">lavaan::lavaan()</a></code>.
See <code><a href="https://rdrr.io/pkg/lavaan/man/lavOptions.html" class="external-link">lavaan::lavOptions()</a></code> on this argument. Default is
<code>"default"</code>. If the plot is too irregular, try setting it to
<code>"simple"</code>.</p></dd>


<dt>try_k_more</dt>
<dd><p>How many more times to try finding the p-values,
by randomizing the starting values. Default is 5. Try increasing
this number if the plot is too irregular.</p></dd>


<dt>parallel</dt>
<dd><p>If <code>TRUE</code>, parallel processing will be used. A
cluster will be created by <code><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">parallel::makeCluster()</a></code>, with the
number of workers equal to <code>ncpus</code>. Parallel processing, though
not enabled by default, is recommended because it can speed up
the computation a lot.</p></dd>


<dt>ncpus</dt>
<dd><p>The number of workers if <code>parallel</code> is <code>TRUE</code>. Default
is <code>parallel::detectCores(logical = FALSE) - 1</code>, the number of
physical cores minus 1.</p></dd>


<dt>use_pbapply</dt>
<dd><p>If <code>TRUE</code> and <a href="https://rdrr.io/pkg/pbapply/man/pbapply.html" class="external-link">pbapply::pbapply</a> is installed,
<a href="https://rdrr.io/pkg/pbapply/man/pbapply.html" class="external-link">pbapply::pbapply</a> will be used to display the progress in
computing the log profile likelihood. Default is <code>TRUE</code>.</p></dd>


<dt>theta0</dt>
<dd><p>The value at which the parameter is fixed to.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p><code>loglike_point()</code> returns a list with these elements:</p><ul><li><p><code>loglike</code>: The log profile likelihood of the parameter when it is
fixed to <code>theta0</code>.</p></li>
<li><p><code>pvalue</code>: The <em>p</em>-values based on the likelihood ratio difference
test between the original model and the model with the
parameter fixed to <code>theta0</code>.</p></li>
<li><p><code>fit</code>: A <a href="https://rdrr.io/pkg/lavaan/man/lavaan-class.html" class="external-link">lavaan::lavaan</a> object. The original model with
the parameter fixed to <code>theta0</code>.</p></li>
<li><p><code>lrt</code>: The output of <code><a href="https://rdrr.io/pkg/lavaan/man/lavTestLRT.html" class="external-link">lavaan::lavTestLRT()</a></code>, comparing the
original model to the model with the parameter fixed to
<code>theta0</code>.</p></li>
</ul><p><code>loglike_quad_range()</code> returns a data frame with these
columns:</p><ul><li><p><code>theta</code>: The values to which the parameter is fixed to.</p></li>
<li><p><code>loglike</code>: The log profile likelihood values of the parameter
using quadratic approximation.</p></li>
<li><p><code>pvalue</code>: The <em>p</em>-values based on the likelihood ratio difference
test between the original model and the model with the
parameter fixed to theta.</p></li>
</ul><p><code>loglike_quad_point()</code> returns a single number of the class
<code>lavaan.vector</code> (because it is the output of
<code><a href="https://rdrr.io/pkg/lavaan/man/fitMeasures.html" class="external-link">lavaan::fitMeasures()</a></code>). This number is the quadratic
approximation of the log profile likelihood when the parameter is
fixed to <code>theta0</code>.</p>


<p><code>loglike_compare()</code> calls <code>loglike_range()</code> and
<code>loglike_quad_range()</code> and returns their results in a
<code>loglike_compare</code>-class object, a list
with these elements:</p><ul><li><p><code>quadratic</code>: The output of <code>loglike_quad_range()</code>.</p></li>
<li><p><code>loglikelihood</code>: The output of <code>loglike_range()</code>.</p></li>
<li><p><code>pvalue_quadratic</code>: The likelihood ratio test <em>p</em>-values at the
quadratic approximation confidence bounds.</p></li>
<li><p><code>pvalue_loglikelihood</code>: The likelihood ratio test <em>p</em>-values at
the likelihood-based confidence bounds.</p></li>
<li><p><code>est</code>: The point estimate of the parameter in <code>sem_out</code>.</p></li>
</ul><p><code>loglike_compare</code>-class object has a plot method (<code><a href="plot.loglike_compare.html">plot.loglike_compare()</a></code>)
that can be used to plot the log profile likelihood.</p>


<p><code>loglike_range()</code> returns a data frame with these columns:</p><ul><li><p><code>theta</code>: The values to which the parameter is fixed to.</p></li>
<li><p><code>loglike</code>: The log profile likelihood at theta.</p></li>
<li><p><code>pvalue</code>: The <em>p</em>-values based on the likelihood ratio difference
test between the original model and model with the
parameter fixed to theta.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>The methods presented in Pawitan (2013) are used to
compute and visualize the log profile likelihood of a parameter in
a structural equation model when it is fixed to a value or a range
of values. <code>loglike_range()</code> and <code>loglike_point()</code> compute the
so-called "true" log profile likelihood, while
<code>loglike_quad_range()</code> and <code>loglike_quad_point()</code> approximate the log
profile likelihood by a quadratic function.</p>
<p>These functions are for creating illustrative examples and learning
only, not for research use. Therefore, they are not as versatile as
<code><a href="semlbci.html">semlbci()</a></code> in the types of models and parameters supported. They
can be used for free parameters and user-defined parameters not
involved in any constraints. Only a model fitted by maximum
likelihood is supported.</p>
<p>They will not check whether the computation is appropriate for a
model. It is the responsibility of the users to ensure that the
computation is appropriate for the model and parameter.</p>
    </div>
    <div id="functions">
    <h2>Functions</h2>
    
<ul><li><p><code>loglike_range()</code>: Find the log profile likelihood for a range of values.</p></li>
<li><p><code>loglike_point()</code>: Find the log likelihood at a value.</p></li>
<li><p><code>loglike_quad_range()</code>: Find the approximated log likelihood for a range of values.</p></li>
<li><p><code>loglike_quad_point()</code>: Find the approximated log likelihood at a value.</p></li>
<li><p><code>loglike_compare()</code>: Description of this function</p></li>
</ul></div>
    <div id="references">
    <h2>References</h2>
    <p>Pawitan, Y. (2013). <em>In all likelihood: Statistical
modelling and inference using likelihood</em>. Oxford University Press.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="plot.loglike_compare.html">plot.loglike_compare()</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## loglike_range</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be" class="external-link">lavaan</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">simple_med</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">simple_med</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span><span class="st">"</span></span></span>
<span class="r-in"><span><span class="st">m ~ a * x</span></span></span>
<span class="r-in"><span><span class="st">y ~ b * m</span></span></span>
<span class="r-in"><span><span class="st">ab := a * b</span></span></span>
<span class="r-in"><span><span class="st">"</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">lavaan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">sem</a></span><span class="op">(</span><span class="va">mod</span>, <span class="va">simple_med</span>, fixed.x <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Five points are used just for illustration</span></span></span>
<span class="r-in"><span><span class="va">ll_1</span> <span class="op">&lt;-</span> <span class="fu">loglike_range</span><span class="op">(</span><span class="va">fit</span>, par_i <span class="op">=</span> <span class="st">"y ~ m"</span>, n_points <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Finding p-values for LR test</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ll_1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       theta   loglike     pvalue</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.3914228 -1570.448 0.05109878</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.4632527 -1569.024 0.32767455</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.5350826 -1568.545 1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.6069126 -1569.024 0.32767455</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.6787425 -1570.448 0.05109878</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## loglike_point</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be" class="external-link">lavaan</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">simple_med</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">simple_med</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span><span class="st">"</span></span></span>
<span class="r-in"><span><span class="st">m ~ a * x</span></span></span>
<span class="r-in"><span><span class="st">y ~ b * m</span></span></span>
<span class="r-in"><span><span class="st">ab := a * b</span></span></span>
<span class="r-in"><span><span class="st">"</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">lavaan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">sem</a></span><span class="op">(</span><span class="va">mod</span>, <span class="va">simple_med</span>, fixed.x <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">llp_1</span> <span class="op">&lt;-</span> <span class="fu">loglike_point</span><span class="op">(</span>theta0 <span class="op">=</span> <span class="fl">0.3</span>, sem_out <span class="op">=</span> <span class="va">fit</span>, par_i <span class="op">=</span> <span class="st">"y ~ m"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">llp_1</span><span class="op">$</span><span class="va">loglike</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'log Lik.' -1573.561 (df=4)</span>
<span class="r-in"><span><span class="va">llp_1</span><span class="op">$</span><span class="va">pvalue</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.001539546</span>
<span class="r-in"><span><span class="va">llp_1</span><span class="op">$</span><span class="va">lrt</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chi-Squared Difference Test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Df    AIC    BIC  Chisq Chisq diff   RMSEA Df diff Pr(&gt;Chisq)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sem_out  1 3147.1 3163.6 10.549                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit_i    2 3155.1 3168.3 20.579     10.031 0.21249       1    0.00154 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## loglike_quad_range</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be" class="external-link">lavaan</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">simple_med</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">simple_med</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span><span class="st">"</span></span></span>
<span class="r-in"><span><span class="st">m ~ a * x</span></span></span>
<span class="r-in"><span><span class="st">y ~ b * m</span></span></span>
<span class="r-in"><span><span class="st">ab := a * b</span></span></span>
<span class="r-in"><span><span class="st">"</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">lavaan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">sem</a></span><span class="op">(</span><span class="va">mod</span>, <span class="va">simple_med</span>, fixed.x <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Five points are used just for illustration</span></span></span>
<span class="r-in"><span><span class="va">lq_1</span> <span class="op">&lt;-</span> <span class="fu">loglike_quad_range</span><span class="op">(</span><span class="va">fit</span>, par_i <span class="op">=</span> <span class="st">"y ~ m"</span>, n_points <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Finding p-values for quadratic approximation</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">lq_1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       theta   loglike     pvalue</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.3914228 -1570.466 0.05109878</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.4632527 -1569.025 0.32767455</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.5350826 -1568.545 1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.6069126 -1569.025 0.32767455</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.6787425 -1570.466 0.05109878</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## loglike_quad_point</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be" class="external-link">lavaan</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">simple_med</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">simple_med</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span><span class="st">"</span></span></span>
<span class="r-in"><span><span class="st">m ~ a * x</span></span></span>
<span class="r-in"><span><span class="st">y ~ b * m</span></span></span>
<span class="r-in"><span><span class="st">ab := a * b</span></span></span>
<span class="r-in"><span><span class="st">"</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">lavaan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">sem</a></span><span class="op">(</span><span class="va">mod</span>, <span class="va">simple_med</span>, fixed.x <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">lqp_1</span> <span class="op">&lt;-</span> <span class="fu">loglike_quad_point</span><span class="op">(</span>theta0 <span class="op">=</span> <span class="fl">0.3</span>, sem_out <span class="op">=</span> <span class="va">fit</span>, par_i <span class="op">=</span> <span class="st">"y ~ m"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lqp_1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      logl </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1573.688 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## loglike_compare</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be" class="external-link">lavaan</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">simple_med</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">simple_med</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span><span class="st">"</span></span></span>
<span class="r-in"><span><span class="st">m ~ a * x</span></span></span>
<span class="r-in"><span><span class="st">y ~ b * m</span></span></span>
<span class="r-in"><span><span class="st">ab := a * b</span></span></span>
<span class="r-in"><span><span class="st">"</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">lavaan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">sem</a></span><span class="op">(</span><span class="va">mod</span>, <span class="va">simple_med</span>, fixed.x <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Five points are used just for illustration</span></span></span>
<span class="r-in"><span><span class="co"># At least 21 points should be used for a smooth plot</span></span></span>
<span class="r-in"><span><span class="va">ll_all</span> <span class="op">&lt;-</span> <span class="fu">loglike_compare</span><span class="op">(</span><span class="va">fit</span>, par_i <span class="op">=</span> <span class="st">"ab := "</span>, n_points <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Finding p-values for quadratic approximation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Finding p-values for LR test</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ll_all</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 4 rows containing missing values (`geom_text_repel()`).</span>
<span class="r-plt img"><img src="loglikelihood-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Shu Fai Cheung.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

