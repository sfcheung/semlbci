<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Log Profile likelihood of a Parameter — loglike_compare • semlbci</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Inter-0.4.9/font.css" rel="stylesheet"><link href="../deps/Cousine-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Log Profile likelihood of a Parameter — loglike_compare"><meta name="description" content="These functions compute the log profile likelihood of
a parameter when it is fixed to a value or a range of values"><meta property="og:description" content="These functions compute the log profile likelihood of
a parameter when it is fixed to a value or a range of values"><meta property="og:image" content="https://sfcheung.github.io/semlbci/logo.png"><meta name="google-site-verification" content="0VLBmFnW_UJFI-7gXnORPBsWxqZwmzuGpK-TeVRLBjQ"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">semlbci</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.11.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/semlbci.html">Get started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/loglike.html">Log Profile Likelihood of a Parameter</a></li>
    <li><a class="dropdown-item" href="../articles/technical_searching_one_bound.html">Searching for One Bound</a></li>
    <li><a class="dropdown-item" href="../articles/technical_workflow.html">Internal Workflow of semlbci()</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sfcheung/semlbci/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Log Profile likelihood of a Parameter</h1>
      <small class="dont-index">Source: <a href="https://github.com/sfcheung/semlbci/blob/master/R/loglike_at.R" class="external-link"><code>R/loglike_at.R</code></a>, <a href="https://github.com/sfcheung/semlbci/blob/master/R/loglike_at_user.R" class="external-link"><code>R/loglike_at_user.R</code></a></small>
      <div class="d-none name"><code>loglikelihood.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These functions compute the log profile likelihood of
a parameter when it is fixed to a value or a range of values</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">loglike_compare</span><span class="op">(</span></span>
<span>  <span class="va">sem_out</span>,</span>
<span>  semlbci_out <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">par_i</span>,</span>
<span>  confidence <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  n_points <span class="op">=</span> <span class="fl">21</span>,</span>
<span>  start <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  try_k_more <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ncpus <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span>logical <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>  use_pbapply <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">loglike_range</span><span class="op">(</span></span>
<span>  <span class="va">sem_out</span>,</span>
<span>  <span class="va">par_i</span>,</span>
<span>  confidence <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  n_points <span class="op">=</span> <span class="fl">21</span>,</span>
<span>  interval <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  start <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  try_k_more <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ncpus <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span>logical <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>  use_pbapply <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">loglike_point</span><span class="op">(</span></span>
<span>  <span class="va">theta0</span>,</span>
<span>  <span class="va">sem_out</span>,</span>
<span>  <span class="va">par_i</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  start <span class="op">=</span> <span class="st">"default"</span>,</span>
<span>  try_k_more <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">loglike_quad_range</span><span class="op">(</span></span>
<span>  <span class="va">sem_out</span>,</span>
<span>  <span class="va">par_i</span>,</span>
<span>  confidence <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  n_points <span class="op">=</span> <span class="fl">21</span>,</span>
<span>  interval <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ncpus <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span>logical <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>  use_pbapply <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  try_k_more <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  start <span class="op">=</span> <span class="st">"default"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">loglike_quad_point</span><span class="op">(</span><span class="va">theta0</span>, <span class="va">sem_out</span>, <span class="va">par_i</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">loglike_compare_ur</span><span class="op">(</span></span>
<span>  <span class="va">sem_out</span>,</span>
<span>  semlbci_out <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">par_i</span>,</span>
<span>  confidence <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  n_points <span class="op">=</span> <span class="fl">21</span>,</span>
<span>  standardized <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ncpus <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span>logical <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>  use_pbapply <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  loadbalancing <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">loglike_range_ur</span><span class="op">(</span></span>
<span>  <span class="va">sem_out</span>,</span>
<span>  <span class="va">par_i</span>,</span>
<span>  standardized <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  confidence <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  n_points <span class="op">=</span> <span class="fl">21</span>,</span>
<span>  interval <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ncpus <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span>logical <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>  use_pbapply <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  loadbalancing <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">loglike_point_ur</span><span class="op">(</span><span class="va">theta0</span>, <span class="va">sem_out</span>, <span class="va">par_i</span>, standardized <span class="op">=</span> <span class="cn">FALSE</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">loglike_quad_range_ur</span><span class="op">(</span></span>
<span>  <span class="va">sem_out</span>,</span>
<span>  <span class="va">par_i</span>,</span>
<span>  confidence <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  standardized <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n_points <span class="op">=</span> <span class="fl">21</span>,</span>
<span>  interval <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ncpus <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span>logical <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>  use_pbapply <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  loadbalancing <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">loglike_quad_point_ur</span><span class="op">(</span><span class="va">theta0</span>, <span class="va">sem_out</span>, <span class="va">par_i</span>, standardized <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-sem-out">sem_out<a class="anchor" aria-label="anchor" href="#arg-sem-out"></a></dt>
<dd><p>The SEM output. Currently the outputs
of <code><a href="https://rdrr.io/pkg/lavaan/man/lavaan.html" class="external-link">lavaan::lavaan()</a></code> or its wrappers, such as <code><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">lavaan::sem()</a></code>
and <code><a href="https://rdrr.io/pkg/lavaan/man/cfa.html" class="external-link">lavaan::cfa()</a></code> are supported.</p></dd>


<dt id="arg-semlbci-out">semlbci_out<a class="anchor" aria-label="anchor" href="#arg-semlbci-out"></a></dt>
<dd><p>The output of <code><a href="semlbci.html">semlbci()</a></code>.
If supplied, it will extract the likelihood-based confidence
interval from the output. If not, it will call <code><a href="semlbci.html">semlbci()</a></code>.</p></dd>


<dt id="arg-par-i">par_i<a class="anchor" aria-label="anchor" href="#arg-par-i"></a></dt>
<dd><p>The row number of the parameter in the output of
<code><a href="https://rdrr.io/pkg/lavaan/man/parTable.html" class="external-link">lavaan::parameterTable()</a></code>. Can also be a <a href="https://rdrr.io/pkg/lavaan/man/model.syntax.html" class="external-link">lavaan::model.syntax</a>
specification for a parameter, e.g., <code>"y ~ x"</code> or <code>ab := </code>.
It will be converted to the row number by <code><a href="syntax_to_i.html">syntax_to_i()</a></code>. Refer to
<code><a href="syntax_to_i.html">syntax_to_i()</a></code> for details.</p></dd>


<dt id="arg-confidence">confidence<a class="anchor" aria-label="anchor" href="#arg-confidence"></a></dt>
<dd><p>The level of confidence of the Wald-type
confidence interval. If <code>interval</code> is <code>NULL</code>, this confidence is
used to form the interval.</p></dd>


<dt id="arg-n-points">n_points<a class="anchor" aria-label="anchor" href="#arg-n-points"></a></dt>
<dd><p>The number of points to be evaluated in the
interval. Default is 21.</p></dd>


<dt id="arg-start">start<a class="anchor" aria-label="anchor" href="#arg-start"></a></dt>
<dd><p>How the start values are set in <code><a href="https://rdrr.io/pkg/lavaan/man/lavaan.html" class="external-link">lavaan::lavaan()</a></code>.
See <code><a href="https://rdrr.io/pkg/lavaan/man/lavOptions.html" class="external-link">lavaan::lavOptions()</a></code> on this argument. Default is
<code>"default"</code>. If the plot is too irregular, try setting it to
<code>"simple"</code>.</p></dd>


<dt id="arg-try-k-more">try_k_more<a class="anchor" aria-label="anchor" href="#arg-try-k-more"></a></dt>
<dd><p>How many more times to try finding the p-values,
by randomizing the starting values. Default is 5. Try increasing
this number if the plot is too irregular.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>If <code>TRUE</code>, parallel processing will be used. A
cluster will be created by <code><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">parallel::makeCluster()</a></code>, with the
number of workers equal to <code>ncpus</code>. Parallel processing, though
not enabled by default, is recommended because it can speed up
the computation a lot.</p></dd>


<dt id="arg-ncpus">ncpus<a class="anchor" aria-label="anchor" href="#arg-ncpus"></a></dt>
<dd><p>The number of workers if <code>parallel</code> is <code>TRUE</code>. Default
is <code>parallel::detectCores(logical = FALSE) - 1</code>, the number of
physical cores minus 1.</p></dd>


<dt id="arg-use-pbapply">use_pbapply<a class="anchor" aria-label="anchor" href="#arg-use-pbapply"></a></dt>
<dd><p>If <code>TRUE</code> and <a href="https://rdrr.io/pkg/pbapply/man/pbapply.html" class="external-link">pbapply::pbapply</a> is installed,
<a href="https://rdrr.io/pkg/pbapply/man/pbapply.html" class="external-link">pbapply::pbapply</a> will be used to display the progress in
computing the log profile likelihood. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-interval">interval<a class="anchor" aria-label="anchor" href="#arg-interval"></a></dt>
<dd><p>A vector of numbers. If provided and has two
elements, this will be used as the end points of the interval. If
it has more than two elements, the elements will be used directly
to form the values in the interval. Default is <code>NULL</code>.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Whether some diagnostic information will be printed.
Default is <code>FALSE</code>.</p></dd>


<dt id="arg-theta-">theta0<a class="anchor" aria-label="anchor" href="#arg-theta-"></a></dt>
<dd><p>The value at which the parameter is fixed to.</p></dd>


<dt id="arg-standardized">standardized<a class="anchor" aria-label="anchor" href="#arg-standardized"></a></dt>
<dd><p>Logical. Whether
the parameter requested is in the
standardized solution. Default is
<code>FALSE</code>.</p></dd>


<dt id="arg-loadbalancing">loadbalancing<a class="anchor" aria-label="anchor" href="#arg-loadbalancing"></a></dt>
<dd><p>Logical. When
using parallel processing, whether
load balancing is used. Default is
<code>TRUE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>loglike_compare()</code> calls <code>loglike_range()</code> and
<code>loglike_quad_range()</code> and returns their results in a
<code>loglike_compare</code>-class object, a list
with these elements:</p><ul><li><p><code>quadratic</code>: The output of <code>loglike_quad_range()</code>.</p></li>
<li><p><code>loglikelihood</code>: The output of <code>loglike_range()</code>.</p></li>
<li><p><code>pvalue_quadratic</code>: The likelihood ratio test <em>p</em>-values at the
quadratic approximation confidence bounds.</p></li>
<li><p><code>pvalue_loglikelihood</code>: The likelihood ratio test <em>p</em>-values at
the likelihood-based confidence bounds.</p></li>
<li><p><code>est</code>: The point estimate of the parameter in <code>sem_out</code>.</p></li>
</ul><p><code>loglike_compare</code>-class object has a <code>plot</code> method (<code><a href="plot.loglike_compare.html">plot.loglike_compare()</a></code>)
that can be used to plot the log profile likelihood.</p>
<p><code>loglike_point()</code> returns a list with these elements:</p><ul><li><p><code>loglike</code>: The log profile likelihood of the parameter when it is
fixed to <code>theta0</code>.</p></li>
<li><p><code>pvalue</code>: The <em>p</em>-values based on the likelihood ratio difference
test between the original model and the model with the
parameter fixed to <code>theta0</code>.</p></li>
<li><p><code>fit</code>: A <a href="https://rdrr.io/pkg/lavaan/man/lavaan-class.html" class="external-link">lavaan::lavaan</a> object. The original model with
the parameter fixed to <code>theta0</code>.</p></li>
<li><p><code>lrt</code>: The output of <code><a href="https://rdrr.io/pkg/lavaan/man/lavTestLRT.html" class="external-link">lavaan::lavTestLRT()</a></code>, comparing the
original model to the model with the parameter fixed to
<code>theta0</code>.</p></li>
</ul><p><code>loglike_quad_range()</code> returns a data frame with these
columns:</p><ul><li><p><code>theta</code>: The values to which the parameter is fixed to.</p></li>
<li><p><code>loglike</code>: The log profile likelihood values of the parameter
using quadratic approximation.</p></li>
<li><p><code>pvalue</code>: The <em>p</em>-values based on the likelihood ratio difference
test between the original model and the model with the
parameter fixed to <code>theta</code>.</p></li>
</ul><p><code>loglike_quad_point()</code> returns a single number of the class
<code>lavaan.vector</code> (because it is the output of
<code><a href="https://rdrr.io/pkg/lavaan/man/fitMeasures.html" class="external-link">lavaan::fitMeasures()</a></code>). This number is the quadratic
approximation of the log profile likelihood when the parameter is
fixed to <code>theta0</code>.</p>
<p><code>loglike_range()</code> returns a data frame with these columns:</p><ul><li><p><code>theta</code>: The values to which the parameter is fixed to.</p></li>
<li><p><code>loglike</code>: The log profile likelihood at <code>theta</code>.</p></li>
<li><p><code>pvalue</code>: The <em>p</em>-values based on the likelihood ratio difference
test between the original model and model with the
parameter fixed to <code>theta</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>It uses the methods presented in Pawitan (2013) to
compute and visualize the log profile likelihood of a parameter in
a structural equation model when this parameter is fixed to a value or
a range
of values. <code>loglike_range()</code> and <code>loglike_point()</code> compute the
so-called "true" log profile likelihood, while
<code>loglike_quad_range()</code> and <code>loglike_quad_point()</code> approximate the log
profile likelihood by a quadratic function.</p>
<p>These functions are for creating illustrative examples and learning
only, not for research use. Therefore, they are not as versatile as
<code><a href="semlbci.html">semlbci()</a></code> in the types of models and parameters supported. They
can be used for free parameters and user-defined parameters not
involved in any constraints. Only a model fitted by maximum
likelihood is supported.</p>
<p>They will not check whether the computation is appropriate for a
model. It is the responsibility of the users to ensure that the
computation is appropriate for the model and parameter.</p>
<p>In version 0.11.2.1, added variants
of the function, with suffix <code>_ur</code>,
which use root finding (<code>"ur"</code> in
<code><a href="semlbci.html">semlbci()</a></code>). These variants are
slower to run but can be used for
parameter in the standardized
solution. Therefore, they can used to
generate plots for parameters such as
standardized regression paths and
correlations.</p>
    </div>
    <div class="section level2">
    <h2 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a></h2>

<ul><li><p><code>loglike_compare()</code>: Generates points for log profile likelihood and
quadratic approximation, by calling the helper functions <code>loglike_range()</code>
and <code>loglike_quad_range()</code>.</p></li>
<li><p><code>loglike_range()</code>: Find the log profile likelihood for a range of values.</p></li>
<li><p><code>loglike_point()</code>: Find the log likelihood at a value.</p></li>
<li><p><code>loglike_quad_range()</code>: Find the approximated log likelihood for a range of values.</p></li>
<li><p><code>loglike_quad_point()</code>: Find the approximated log likelihood at a value.</p></li>
<li><p><code>loglike_compare_ur()</code>: Generates
points for log profile likelihood and
quadratic approximation using root
finding, by calling the helper
functions <code>loglike_range_ur()</code> and
<code>loglike_quad_range_ur()</code>.</p></li>
<li><p><code>loglike_range_ur()</code>: Find the
log profile likelihood for a range of
values using root finding.</p></li>
<li><p><code>loglike_point_ur()</code>: Find the
log likelihood at a value.</p></li>
<li><p><code>loglike_quad_range_ur()</code>: Find the
approximated log likelihood for a
range of values using root finding.</p></li>
<li><p><code>loglike_quad_point_ur()</code>: Find the
approximated log likelihood at a
value. Support a parameter in the
standardized solution.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Pawitan, Y. (2013). <em>In all likelihood: Statistical
modelling and inference using likelihood</em>. Oxford University Press.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="plot.loglike_compare.html">plot.loglike_compare()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## loglike_compare</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lavaan.ugent.be" class="external-link">lavaan</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">simple_med</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">simple_med</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span><span class="st">"</span></span></span>
<span class="r-in"><span><span class="st">m ~ a * x</span></span></span>
<span class="r-in"><span><span class="st">y ~ b * m</span></span></span>
<span class="r-in"><span><span class="st">ab := a * b</span></span></span>
<span class="r-in"><span><span class="st">"</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">lavaan</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lavaan/man/sem.html" class="external-link">sem</a></span><span class="op">(</span><span class="va">mod</span>, <span class="va">simple_med</span>, fixed.x <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 4 points are used just for illustration</span></span></span>
<span class="r-in"><span><span class="co"># At least 21 points should be used for a smooth plot</span></span></span>
<span class="r-in"><span><span class="co"># Remove try_k_more in real applications. It is set</span></span></span>
<span class="r-in"><span><span class="co"># to zero such that this example does not take too long to run.</span></span></span>
<span class="r-in"><span><span class="co"># use_pbapply can be removed or set to TRUE to show the progress.</span></span></span>
<span class="r-in"><span><span class="va">ll_a</span> <span class="op">&lt;-</span> <span class="fu">loglike_compare</span><span class="op">(</span><span class="va">fit</span>, par_i <span class="op">=</span> <span class="st">"m ~ x"</span>, n_points <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>                        try_k_more <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                        use_pbapply <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ll_a</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="loglikelihood-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># See the vignette "loglike" for an example for the</span></span></span>
<span class="r-in"><span><span class="co"># indirect effect.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## loglike_range</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Usually not to be used directly.</span></span></span>
<span class="r-in"><span><span class="co"># Used by loglike_compare().</span></span></span>
<span class="r-in"><span><span class="co"># 3 points are used just for illustration</span></span></span>
<span class="r-in"><span><span class="va">ll_1</span> <span class="op">&lt;-</span> <span class="fu">loglike_range</span><span class="op">(</span><span class="va">fit</span>, par_i <span class="op">=</span> <span class="st">"y ~ m"</span>, n_points <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Finding p-values for LR test</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ll_1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       theta   loglike     pvalue</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.3914228 -1570.448 0.05109878</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.6787425 -1570.448 0.05109878</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## loglike_point</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Usually not to be used directly.</span></span></span>
<span class="r-in"><span><span class="co"># Used by loglike_compare().</span></span></span>
<span class="r-in"><span><span class="va">llp_1</span> <span class="op">&lt;-</span> <span class="fu">loglike_point</span><span class="op">(</span>theta0 <span class="op">=</span> <span class="fl">0.3</span>, sem_out <span class="op">=</span> <span class="va">fit</span>, par_i <span class="op">=</span> <span class="st">"y ~ m"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">llp_1</span><span class="op">$</span><span class="va">loglike</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'log Lik.' -1573.561 (df=4)</span>
<span class="r-in"><span><span class="va">llp_1</span><span class="op">$</span><span class="va">pvalue</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.001539546</span>
<span class="r-in"><span><span class="va">llp_1</span><span class="op">$</span><span class="va">lrt</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chi-Squared Difference Test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Df    AIC    BIC  Chisq Chisq diff   RMSEA Df diff Pr(&gt;Chisq)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sem_out  1 3147.1 3163.6 10.549                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit_i    2 3155.1 3168.3 20.579     10.031 0.21249       1    0.00154 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## loglike_quad_range</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Usually not to be used directly.</span></span></span>
<span class="r-in"><span><span class="co"># Used by loglike_compare().</span></span></span>
<span class="r-in"><span><span class="co"># 2 points are used just for illustration</span></span></span>
<span class="r-in"><span><span class="va">lq_1</span> <span class="op">&lt;-</span> <span class="fu">loglike_quad_range</span><span class="op">(</span><span class="va">fit</span>, par_i <span class="op">=</span> <span class="st">"y ~ m"</span>, n_points <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Finding p-values for quadratic approximation</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">lq_1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       theta   loglike     pvalue</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.3914228 -1570.466 0.05109878</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.6787425 -1570.466 0.05109878</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## loglike_quad_point</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Usually not to be used directly.</span></span></span>
<span class="r-in"><span><span class="co"># Used by loglike_compare().</span></span></span>
<span class="r-in"><span><span class="va">lqp_1</span> <span class="op">&lt;-</span> <span class="fu">loglike_quad_point</span><span class="op">(</span>theta0 <span class="op">=</span> <span class="fl">0.3</span>, sem_out <span class="op">=</span> <span class="va">fit</span>, par_i <span class="op">=</span> <span class="st">"y ~ m"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lqp_1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      logl </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1573.688 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Shu Fai Cheung.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

