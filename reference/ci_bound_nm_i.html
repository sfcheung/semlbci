<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Find the lower or upper bound for one parameter by
the Neale-Miller-1997 approach — ci_bound_nm_i • semlbci</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Find the lower or upper bound for one parameter by
the Neale-Miller-1997 approach — ci_bound_nm_i" />
<meta property="og:description" content="Find the lower or upper bound of the
likelihood-based confidence interval (LBCI) for one parameter
by the Neale-Miller-1997 approach." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">semlbci</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/quick_start.html">Quick Start</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Find the lower or upper bound for one parameter by
the Neale-Miller-1997 approach</h1>
    
    <div class="hidden name"><code>ci_bound_nm_i.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Find the lower or upper bound of the
likelihood-based confidence interval (LBCI) for one parameter
by the Neale-Miller-1997 approach.</p>
    </div>

    <pre class="usage"><span class='fu'>ci_bound_nm_i</span><span class='op'>(</span>
  i <span class='op'>=</span> <span class='cn'>NULL</span>,
  npar <span class='op'>=</span> <span class='cn'>NULL</span>,
  sem_out <span class='op'>=</span> <span class='cn'>NULL</span>,
  f_constr <span class='op'>=</span> <span class='cn'>NULL</span>,
  which <span class='op'>=</span> <span class='cn'>NULL</span>,
  history <span class='op'>=</span> <span class='cn'>FALSE</span>,
  perturbation_factor <span class='op'>=</span> <span class='fl'>0.9</span>,
  lb_var <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>,
  wald_ci_start <span class='op'>=</span> <span class='cn'>TRUE</span>,
  standardized <span class='op'>=</span> <span class='cn'>FALSE</span>,
  opts <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  test_generic <span class='op'>=</span> <span class='cn'>TRUE</span>,
  ciperc <span class='op'>=</span> <span class='fl'>0.95</span>,
  ci_limit_ratio_tol <span class='op'>=</span> <span class='fl'>1.5</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>i</th>
      <td><p>The position of the target parameters as in the parameter table of
lavaan as generated by <code><a href='https://rdrr.io/pkg/lavaan/man/model.syntax.html'>lavaan::parameterTable()</a></code>.</p></td>
    </tr>
    <tr>
      <th>npar</th>
      <td><p>The number of free parameters, including those constrained to be
equal.</p></td>
    </tr>
    <tr>
      <th>sem_out</th>
      <td><p>The fit object. Currently supports a
<a href='https://rdrr.io/pkg/lavaan/man/lavaan-class.html'>lavaan::lavaan</a> object only.</p></td>
    </tr>
    <tr>
      <th>f_constr</th>
      <td><p>The constraint function generated by <code>set_constraint_nm</code>.
This argument is no longer used because the constraint
function will be
generated internally.</p></td>
    </tr>
    <tr>
      <th>which</th>
      <td><p>Whether the lower bound or the upper bound is to be found. Must
be <code>"lbound"</code> or <code>"ubound"</code>.</p></td>
    </tr>
    <tr>
      <th>history</th>
      <td><p>If <code>TRUE</code>, return the full optimization output as an
attribute. Default is <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>perturbation_factor</th>
      <td><p>A number multiplied to the parameter
estimates in <code>sem_out</code>.
Using the parameter estimates as starting
values may lead to errors
in the first few iterations. Default is .90.
This argument is ignored is <code>wald_ci_start</code>
is `TRUE.</p></td>
    </tr>
    <tr>
      <th>lb_var</th>
      <td><p>The lower bound for free parameters that are variances.
Default is <code>-Inf</code>. This is not an admissible
value but seems to be necessary when we need to find
the LBCI bound for a user-defined parameter.</p></td>
    </tr>
    <tr>
      <th>wald_ci_start</th>
      <td><p>If <code>TRUE</code> and there are no equality constraints in
the model, Wald confidence limit will
be used as the starting value for the target parameter
if it is not a userd-defined paramter.</p></td>
    </tr>
    <tr>
      <th>standardized</th>
      <td><p>If <code>TRUE</code>, the LBCI is for the requested estimate in the
standardized solution. Default is <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>opts</th>
      <td><p>Options to be passed to <code><a href='https://rdrr.io/pkg/nloptr/man/nloptr.html'>nloptr::nloptr()</a></code>. Default is <code><a href='https://rdrr.io/r/base/list.html'>list()</a></code></p></td>
    </tr>
    <tr>
      <th>test_generic</th>
      <td><p>If <code>TRUE</code>, will use the generic functions that are
used for free parameters, user defined parameters, and
standardized solution. The generic functions are now
the only options.
Therefore, this argument will be ignored.</p></td>
    </tr>
    <tr>
      <th>ciperc</th>
      <td><p>The proportion of coverage for the confidence interval. Default
is .95.</p></td>
    </tr>
    <tr>
      <th>ci_limit_ratio_tol</th>
      <td><p>The tolerance for the ratio of <code>a</code> to <code>b</code>,
where <code>a</code> is
the distance between an LBCI limit and the
point estimate, and the <code>b</code> is the distance between the
original confidence limit (by default the Wald CI in
<code><a href='https://rdrr.io/pkg/lavaan/man/lavaan.html'>lavaan::lavaan()</a></code>)
and the point estimate. If the ratio is larger than this value,
a warning is set in the status code.
Default is 1.5.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>If <code>TRUE</code>, the function will store more diagnostic information
in the attribute <code>diag</code>.
Default is <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Optional arguments. Not used.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A one-element numeric vector with the requested bound.</p>
<p>The attribute <code>diag</code> contains basic information in the optimization process.
If <code>verbose</code> is <code>TRUE</code>, more information is stored in this attribute.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    
<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>NOTE</h3>


<p>This function is not supposed to be used directly by users. It is
exported such that interested users can examine how a confidence bound is
found.</p>

<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Algorithm</h3>


<p>This function currently supports <code><a href='https://rdrr.io/pkg/lavaan/man/lavaan.html'>lavaan::lavaan()</a></code> outputs only. This
function implements
a version of the algorithm presented in Neale and Miller (1997) that
use an equality constraint (see Pritikin, Rappaport, &amp; Miller, 2017).</p>

<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Limitation(s)</h3>


<p>This function not yet implements the method
for an estimate close to an attainable bound (see Pritikin,
Rappaport, &amp; Miller, 2017).</p>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Neale, M. C., &amp; Miller, M. B. (1997). The use of likelihood-based confidence
intervals in genetic models. <em>Behavior Genetics, 27</em>(2), 113–120.
<a href='https://doi.org/10.1023/A:1025681223921'>https://doi.org/10.1023/A:1025681223921</a></p>
<p>Pritikin, J. N., Rappaport, L. M., &amp; Neale, M. C. (2017). Likelihood-based
confidence intervals for a parameter with an upper or lower bound.
<em>Structural Equation Modeling: A Multidisciplinary Journal, 24</em>(3), 395–401.
<a href='https://doi.org/10.1080/10705511.2016.1275969'>https://doi.org/10.1080/10705511.2016.1275969</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='semlbci.html'>semlbci()</a></code>, <code><a href='ci_i.html'>ci_i()</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>simple_med</span><span class='op'>)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>simple_med</span>
<span class='va'>mod</span> <span class='op'>&lt;-</span>
<span class='st'>"
m ~ x
y ~ m
"</span>
<span class='va'>fit_med</span> <span class='op'>&lt;-</span> <span class='fu'>lavaan</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/lavaan/man/sem.html'>sem</a></span><span class='op'>(</span><span class='va'>mod</span>, <span class='va'>simple_med</span>, fixed.x <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='va'>out1l</span> <span class='op'>&lt;-</span> <span class='fu'>ci_bound_nm_i</span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>5</span>, sem_out <span class='op'>=</span> <span class='va'>fit_med</span>, which <span class='op'>=</span> <span class='st'>"lbound"</span><span class='op'>)</span>
<span class='va'>out1l</span>
</div><div class='output co'>#&gt; [1] 0.8277017
#&gt; attr(,"diag")
#&gt; attr(,"diag")$status
#&gt; [1] 0
#&gt; 
#&gt; attr(,"diag")$est_org
#&gt; [1] 1.676127
#&gt; 
#&gt; attr(,"diag")$ci_org_limit
#&gt; [1] 0.8317719
#&gt; 
#&gt; attr(,"diag")$ci_limit_ratio
#&gt; [1] 1.004821
#&gt; 
#&gt; attr(,"diag")$fit_post_check
#&gt; [1] TRUE
#&gt; 
#&gt; attr(,"diag")$start_values
#&gt; [1] 0.8317719
#&gt; 
#&gt; attr(,"diag")$bound_unchecked
#&gt; [1] 0.8277017
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Shu Fai Cheung.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


